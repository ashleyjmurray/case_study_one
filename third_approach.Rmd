---
title: "Predicting the Lifespan of World Leaders"
author: "Cathy Lee, Alice Liao, Ashley Murray, and Matty Pahren"
date: "8-31-20"
output: pdf_document
---

```{r, setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# I. Introduction

World leaders are influential people that have the power to impact millions of people's lives. Some leaders are elected for terms while others serve for life, so their expected survival is of great interest. In this paper, we seek to examine Popes, U.S. Presidents, Dalai Lamas, Chinese Emperors, and Japanese Emperors to see how their lifespans compare. Additionally, we want to analyze the impact of a leader's birth year on survival, and whether or not this impact might vary depending on the type of leadership. After we build a model to analyze the effects, we also wish to obtain predictions for the lifespans of leaders that are currently alive, as well as make comparative statements about the survival times of these leaders. We will accomplish this by using survival analysis. We use Bayesian Inference to estimate the model parameters with the help of the JAGS program. 

The rest of the paper is structured as follows. First, we will describe the data used to carry out our analysis. Then, we will discuss the Weibull model and Bayesian framework used to ground our analysis plan. Then, we will show how we carried out our analysis plan and recount our results. After that, we discuss our conclusions and areas for further research. Finally, our code and some additional information can be found in the Appendix. 


# II. Data

## II a. Description of the Data

The data used in this analysis contains entries for 177 different world leaders. The types of world leaders present in the data include Popes, US Presidents, Dalai Lamas, Chinese Emperors, and Japanese Emperors. Each individual's birth date and their leadership position is recorded. We calculated each leader's birth year from the birth date column. For some of these groups, we have data dating all the way back to the 14th century. Additionally, leaders who have passed away also have their death date and age of death recorded. For leaders that are still living, these columns instead contain the date the dataset was created (July 31, 2020) and their current age on that date. We updated that date to the due date of the report, August 31, 2020. In order to further clarify who is dead or alive, there is a column titled "Censored," which takes a value of 0 if the person is dead and a value of 1 if that person is still alive. Related to this, there is another column called "Fail," which takes on a value of 1 if the person is dead and a value of 0 if the person is alive. The problem with censored data is that we don't know exactly when a person will die. Thus, we have to come up with a way to model a censored person's death date if we use them in building our model. In total, there are 10 living leaders in our dataset, whose ages we are trying to predict. 

```{r, message=F, include=F}
# import libraries
library(R2jags)
library(tidyverse)
library(ggplot2)
library(lubridate)
install.packages("TruncatedDistributions", repos="http://R-Forge.R-project.org") 
library(TruncatedDistributions)
library(knitr)
library(broom)
library(coda)
library(gridExtra)
library(grid)
```

```{r, include=F}
# clean data and make sure columns have the right type
leaders_data <- get(load("Leaders.RData"))
leaders_data$Censored[leaders$Name == "Jianwen Emperor"] <- "0" #typo for Jianwen Emperor

# reset censoring end date
leaders_data = leaders_data %>%
  mutate(Event.Date = case_when(
    Censored == 1 ~ as.Date("2020-08-31"),
    TRUE ~ Event.Date
  )) %>%
  mutate(Age.Event = as.numeric(time_length(difftime(Event.Date, Birth.Date), "years")))

leaders_data$Censored <- as.factor(leaders_data$Censored)
leaders_data$Type <- as.factor(leaders_data$Type)
leaders_data$Age.Event <- as.numeric(leaders_data$Age.Event)

summary(leaders_data)

# 10 censored data
leaders_data$Name[leaders_data$Censored == "1"]

# create birth year
leaders_data$Birth.Year <- year(leaders_data$Birth.Date)
```

## II b. Exploratory Data Analysis

```{r, fig.height = 4, fig.wdith=5, echo=F,message=FALSE}
ggplot(data=leaders_data, aes(x=Birth.Year, y = Age.Event, color = Type)) +
  geom_point() + geom_smooth(method="lm", se = F) + 
  ggtitle("Figure 1: Birth Year vs. Lifespan by Leadership Types") + 
  labs(x = "Birth Year", y = "Age of Death/Censorship")

                       #This histogram shows the posterior predictive distribution of the", "difference in lifespan (14th Dalai Lama - Pope Francis).", sep = "\n"))
```

Based on Figure 1, it appears that birth year's association with lifespan does depend on type of leadership. In particular, Dalai Lamas' lifespans are negatively correlated with birth year, whereas the rest of the leader types have positive correlations with birth year. 

```{r, fig.height=2.5, fig.width=5,echo=F}
ggplot(data = leaders_data) +
  geom_boxplot(aes(x = Type, y = Age.Event)) + 
  ggtitle("Figure 2: Distribution of Leader Survival Time") + 
  labs(x = "Type of Leader", y = "Age of Death/Censorship")
```

```{r, fig.height=5, fig.width=9,echo=F}
ggplot(data = leaders_data) +
  geom_histogram(aes(x = Age.Event), binwidth = 5) + 
  ggtitle("Figure 3: Distribution of Age of Death/Censorshiop by Leadership Types") + 
  labs(x = "Age of Death / Censorship") + facet_wrap(~ Type)
```

From the boxplot (Figure 2), we see that the distribution of the lifespans of Popes and US Presidents is centered higher, which makes intuitive sense given that these leaders are elected later in life, while Dalai Lamas and Emperors can be elected at much younger ages. For instance, if a person is a toddler and dies at age five, that person can never be president (and therefore would not have their age be part of the dataset). However, a person can become a Dalai Lama as a toddler and have their age at death be a lot smaller. These same patterns can also be observed in the histograms in Figure 3. Also, in the histograms, there is no extreme skewing, so it does not appear that transformations are needed. 

# III. Methods

## III a. Motivating the Model

We use survival analysis as a way to model $T_i$, the lifespan of a given leader $i$ depending on the leader's year of birth and type of leadership. Survival analysis is useful in that it allows the consideration of "censored" data. This means that we do not always observe the outcome for each data point. For example, we do not know the death date of leaders that are still alive. Thus, we do not know their lifespans, we just know that their survival time $T_i$ will be greater than their current age. 

We model the lifespan $T_i$ of an individual $i$ after the Weibull distribution specified below. We choose to use the Weibull distribution because it is often utilized in survival analysis and allows the user to specify a flexible shape parameter for the distribution. The first parameter $r$, also known as the shape parameter, is a positive scalar, and the second parameter $\mu$, the scale parameter, is a linear function of the covariates (in this case, the century of the birth year and types of leadership as well as their interactions). 

$$T_i \sim Weibull(r, \mu_i) \\$$

$$\log(\mu_i) = \beta_0+ \sum_{j = 1, \cdots, 6} \beta_j I(Birth \ Century_i = j)+ \sum_{k = 7, \cdots, 10}\beta_k I(Leadership_i = k) \\ + \sum_{j = 4, \cdots, 6,\ k = 7}\beta_{j,k} I(Birth \ Century_i = j)*I(Leadership_i = k)  \\ + \sum_{j = 1, \cdots, 6,\ k = 8, \cdots, 10}\beta_{j,k} I(Birth \ Century_i = j)*I(Leadership_i = k)$$

where the indicator functions $Birth \ Century_i = 1, \cdots, 6$ corresponds to a leader $i$ born in the 15th, 16th, 17th, 18th, 19th and 20th century respectively. The 14th century is the baseline for comparison. $Leadership_i = 7, \cdots, 10$ corresponds to a leader $i$ being a U.S. President, a Chinese Emperor, a Dalai Lamai and a Japanese Emperor respectively. $Leadership_i$ uses Pope as the baseline for comparison. $\beta_{j,k}$ is the parameter for the interaction effect between brith year century $j$ and leadership type $k$. 

For example, for Pope Francis who was born in 1963, his birth year century is the 20th century and his leadership type is Pope. $I(Birth \ Century_{Francis} = j)$ will all be 0 except for $j = 6$ (which indicates he was born in the 20th century) and $I(Leadership_i = k)$ will all be 0 since Pope is the baseline for comparison for leadership types. We can write $\log(\mu_{Francis}) = \beta_0 + \beta_6$ for Pope Francis. 

Note that the first U.S. President, George Washington, was born in 1732 (18th century, $j = 4$) and hence the interactions between $Birth \ Century_i= 1,2,3$ (born in the 15th century, 16th century or 17th century) and $Leadership_7$ (being a U.S. President) are meaningless. As such, we didn't include those interaction terms in our model. 

Prior to using this model, we considered a model that used leaders' birth years as a continuous variable instead of binning them into centuries. However, that model resulted in a less desirable model predictive ability as we ran model diagnostics. The residual plot showed a clear trend between residuals and predicted lifespans. Using a quadratic polynomial improved the residuals, but our current model is still superior. Model diagnostics of the current model can be found in section V.c and residual plots of previous models with continuous birth year variable can be found in the Appendix. *make sure we include them in the Appendix*

## III b. Addressing Censored Data

To handle censored observations, we specify their contribution to the likelihood function using the Poisson "zeros trick" and set the upper limit of age of death to 100. Details on this method and how to implement it can be found in Appendix A.1. 

## III c. Prior Choice

We assume that our priors are independent because intuitively a given observation could not be two types of leaders. Additionally, we do not have sufficiently strong prior knowledge about the relationship between birth year and type of leadership to specify an informative prior. Therefore, we use uninformative priors for the betas in our model, in which we chose normal betas with mean 0 and precision 1.0E-3, this includes the coefficients and the intercept in our model.

For our prior for r, we chose a prior of $r \sim exp(0.1)$, as we believe the hazard of death increases with time. This is supported by the fact that older people have higher risk of mortality. For example, in an article by Eurostat, in the European Union in 2016, 82.9% of all deaths happened among people over 65. Within the Appendix A.4, different Weibull distributions are plotted with different values of $r$ in order to showcase the fact that $r \sim exp(0.1)$ gives an increasing rate of hazard, as the shape of the Weibull Distribution starts to have an increasing level of density toward the upper $x$ values for $r \sim exp(0.1)$, compared to smaller values of $r$. 

```{r, include=F}
# create dummy variables
leaders_data <- leaders_data %>%
  mutate(TypeChinaEmp = as.factor(case_when(Type == "ChinaEmp" ~ 1,
                             TRUE ~ 0)),
         TypeDalaiLama = as.factor(case_when(Type == "DalaiLama" ~ 1,
                                   TRUE ~ 0)),
         TypeJapanEmp = as.factor(case_when(Type == "JapanEmp" ~ 1, 
                                  TRUE ~ 0)),
         TypePope = as.factor(case_when(Type == "Pope" ~ 1, 
                              TRUE ~ 0)),
         TypeUsPres = as.factor(case_when(Type == "UsPres" ~ 1,
                                TRUE ~ 0))) %>%
  mutate(Yr14 = as.factor(case_when(year(Birth.Date) <= 1400 ~1,
                                        TRUE ~0)),
         Yr15 = as.factor(case_when(year(Birth.Date) >= 1401 & year(Birth.Date) <= 1500 ~ 1,
                                         TRUE ~0)),
         Yr16 = as.factor(case_when(year(Birth.Date) >= 1501 & year(Birth.Date) <= 1600 ~ 1,
                                         TRUE ~0)),
         Yr17 = as.factor(case_when(year(Birth.Date) >= 1601 & year(Birth.Date) <= 1700 ~ 1,
                                         TRUE ~0)),
         Yr18 = as.factor(case_when(year(Birth.Date) >= 1701 & year(Birth.Date) <= 1800 ~ 1,
                                         TRUE ~0)),
         Yr19 = as.factor(case_when(year(Birth.Date) >= 1801 & year(Birth.Date) <= 1900 ~ 1,
                                         TRUE ~0)),
         Yr20 = as.factor(case_when(year(Birth.Date) >= 1901 & year(Birth.Date) <= 2000 ~ 1,
                                         TRUE ~0))
         ) 

leaders_nopred <- leaders_data 

# set the survival and censored vectors
survival_raw <- leaders_nopred$Age.Event
n <- length(survival_raw)

censored <- leaders_nopred$Censored
survival <- ifelse(censored == 0, survival_raw, NA)

censoring_limits <- ifelse(censored == 0, 100, survival_raw)

x_1 <- as.numeric(as.character(leaders_nopred$Yr15))
x_2 <- as.numeric(as.character(leaders_nopred$Yr16))
x_3 <- as.numeric(as.character(leaders_nopred$Yr17))
x_4 <- as.numeric(as.character(leaders_nopred$Yr18))
x_5 <- as.numeric(as.character(leaders_nopred$Yr19))
x_6 <- as.numeric(as.character(leaders_nopred$Yr20))

x_7 <- as.numeric(as.character(leaders_nopred$TypeUsPres))
x_8 <- as.numeric(as.character(leaders_nopred$TypeChinaEmp))
x_9 <- as.numeric(as.character(leaders_nopred$TypeDalaiLama))
x_10 <- as.numeric(as.character(leaders_nopred$TypeJapanEmp))

# add interaction b/w Yr__ and Type___
x_1_8 <- x_1*x_8
x_1_9 <- x_1*x_9;
x_1_10 <- x_1*x_10

x_2_8 <- x_2*x_8
x_2_9 <- x_2*x_9
x_2_10 <- x_2*x_10

x_3_8 <- x_3*x_8
x_3_9 <- x_3*x_9
x_3_10 <- x_3*x_10

x_4_7 <- x_4*x_7
x_4_8 <- x_4*x_8
x_4_9 <- x_4*x_9
x_4_10 <- x_4*x_10

x_5_7 <- x_5*x_7
x_5_8 <- x_5*x_8
x_5_9 <- x_5*x_9
x_5_10 <- x_5*x_10

x_6_7 <- x_6*x_7
x_6_8 <- x_6*x_8
x_6_9 <- x_6*x_9
x_6_10 <- x_6*x_10
```



```{r, og-model-text, include=F}
# mcmc sampler function
set.seed(123)
build_model <- function() {
  for(i in 1:n_censored) {
    z_censored[i] ~ dpois(phi_censored[i])
    phi_censored[i] <- mu_censored[i] * pow(t_censored[i], r)
    mu_censored[i] <- exp(beta_censored[i])
    beta_censored[i] <- beta_0 + beta_1*x_1_censored[i] + beta_2*x_2_censored[i] + beta_3*x_3_censored[i] + beta_4*x_4_censored[i] + beta_5*x_5_censored[i] + beta_6*x_6_censored[i] + beta_7*x_7_censored[i] + beta_8*x_8_censored[i] + beta_9*x_9_censored[i] + beta_10*x_10_censored[i] + beta_1_8*x_1_8_censored[i] +  beta_1_9*x_1_9_censored[i] + beta_1_10*x_1_10_censored[i] +

          beta_2_8*x_2_8_censored[i] +
          beta_2_9*x_2_9_censored[i] +
          beta_2_10*x_2_10_censored[i] +


          beta_3_8*x_3_8_censored[i] +
          beta_3_9*x_3_9_censored[i] +
          beta_3_10*x_3_10_censored[i] +

          beta_4_7*x_4_7_censored[i] +
          beta_4_8*x_4_8_censored[i] +
          beta_4_9*x_4_9_censored[i] +
          beta_4_10*x_4_10_censored[i] +

          beta_5_7*x_5_7_censored[i] +
          beta_5_8*x_5_8_censored[i] +
          beta_5_9*x_5_9_censored[i] +
          beta_5_10*x_5_10_censored[i] +

          beta_6_7*x_6_7_censored[i] +
          beta_6_8*x_6_8_censored[i] +
          beta_6_9*x_6_9_censored[i] +
          beta_6_10*x_6_10_censored[i]

  }

  for(j in 1:n_non_censored) { 
    survival_non_censored[j] ~ dweib(r, mu[j])
    mu[j] <- exp(beta[j])
    beta[j] <- beta_0 + beta_1*x_1_non_censored[j] +
      beta_2*x_2_non_censored[j] + beta_3*x_3_non_censored[j] + beta_4*x_4_non_censored[j] + beta_5*x_5_non_censored[j] + beta_6*x_6_non_censored[j] + beta_7*x_7_non_censored[j] + beta_8*x_8_non_censored[j] + beta_9*x_9_non_censored[j] + beta_10*x_10_non_censored[j] + beta_1_8*x_1_8_non_censored[j] +  beta_1_9*x_1_9_non_censored[j] + beta_1_10*x_1_10_non_censored[j] +

          beta_2_8*x_2_8_non_censored[j] +
          beta_2_9*x_2_9_non_censored[j] +
          beta_2_10*x_2_10_non_censored[j] +


          beta_3_8*x_3_8_non_censored[j] +
          beta_3_9*x_3_9_non_censored[j] +
          beta_3_10*x_3_10_non_censored[j] +

          beta_4_7*x_4_7_non_censored[j] +
          beta_4_8*x_4_8_non_censored[j] +
          beta_4_9*x_4_9_non_censored[j] +
          beta_4_10*x_4_10_non_censored[j] +

          beta_5_7*x_5_7_non_censored[j] +
          beta_5_8*x_5_8_non_censored[j] +
          beta_5_9*x_5_9_non_censored[j] +
          beta_5_10*x_5_10_non_censored[j] +

          beta_6_7*x_6_7_non_censored[j] +
          beta_6_8*x_6_8_non_censored[j] +
          beta_6_9*x_6_9_non_censored[j] +
          beta_6_10*x_6_10_non_censored[j]
  }



  beta_0 ~ dnorm(0.0, 1.0E-3) # Priors on betas are all normal with low precision
  beta_1 ~ dnorm(0.0, 1.0E-3) 
  beta_2 ~ dnorm(0.0, 1.0E-3) 
  beta_3 ~ dnorm(0.0, 1.0E-3) 
  beta_4 ~ dnorm(0.0, 1.0E-3) 
  beta_5 ~ dnorm(0.0, 1.0E-3) 
  beta_6 ~ dnorm(0.0, 1.0E-3) 
  beta_7 ~ dnorm(0.0, 1.0E-3) 
  beta_8 ~ dnorm(0.0, 1.0E-3) 
  beta_9 ~ dnorm(0.0, 1.0E-3) 
  beta_10 ~ dnorm(0.0, 1.0E-3) 
  beta_1_8 ~ dnorm(0.0, 1.0E-3) 
  beta_1_9 ~ dnorm(0.0, 1.0E-3) 
  beta_1_10 ~ dnorm(0.0, 1.0E-3) 
  beta_2_8 ~ dnorm(0.0, 1.0E-3) 
  beta_2_9 ~ dnorm(0.0, 1.0E-3) 
  beta_2_10 ~ dnorm(0.0, 1.0E-3) 

  beta_3_8 ~ dnorm(0.0, 1.0E-3) 
  beta_3_9 ~ dnorm(0.0, 1.0E-3) 
  beta_3_10 ~ dnorm(0.0, 1.0E-3) 
  beta_4_7 ~ dnorm(0.0, 1.0E-3) 
  beta_4_8 ~ dnorm(0.0, 1.0E-3) 
  beta_4_9 ~ dnorm(0.0, 1.0E-3)
  beta_4_10 ~ dnorm(0.0, 1.0E-3) 
  beta_5_7 ~ dnorm(0.0, 1.0E-3) 
  beta_5_8 ~ dnorm(0.0, 1.0E-3) 
  beta_5_9 ~ dnorm(0.0, 1.0E-3) 
  beta_5_10 ~ dnorm(0.0, 1.0E-3) 
  beta_6_7 ~ dnorm(0.0, 1.0E-3) 
  beta_6_8 ~ dnorm(0.0, 1.0E-3) 
  beta_6_9 ~ dnorm(0.0, 1.0E-3) 
  beta_6_10 ~ dnorm(0.0, 1.0E-3) 

  r ~ dexp(0.1) # Prior on r


   #Define alphas
   alpha_0 <- - beta_0 / r
   alpha_1 <- - beta_1 / r
   alpha_2 <- - beta_2 / r
   alpha_3 <- - beta_3 / r
   alpha_4 <- - beta_4 / r
   alpha_5 <- - beta_5 / r
   alpha_6 <- - beta_6 / r
   alpha_7 <- - beta_7 / r
   alpha_8 <- - beta_8 / r
   alpha_9 <- - beta_9 / r
   alpha_10 <- - beta_10 / r
   alpha_1_8 <- - beta_1_8 / r
   alpha_1_9 <- - beta_1_9 / r
   alpha_1_10 <- - beta_1_10 / r

   alpha_2_8 <- - beta_2_8 / r
   alpha_2_9 <- - beta_2_9 / r
   alpha_2_10 <- - beta_2_10 / r


   alpha_3_8 <- - beta_3_8 / r
   alpha_3_9 <- - beta_3_9 / r
   alpha_3_10 <- - beta_3_10 / r

   alpha_4_7 <- - beta_4_7 / r
   alpha_4_8 <- - beta_4_8 / r
   alpha_4_9 <- - beta_4_9 / r
   alpha_4_10 <- - beta_4_10 / r

   alpha_5_7 <- - beta_5_7 / r
   alpha_5_8 <- - beta_5_8 / r
   alpha_5_9 <- - beta_5_9 / r
   alpha_5_10 <- - beta_5_10 / r

   alpha_6_7 <- - beta_6_7 / r
   alpha_6_8 <- - beta_6_8 / r
   alpha_6_9 <- - beta_6_9 / r
   alpha_6_10 <- - beta_6_10 / r


  # Percentage increases
   p_i_Yr15 <- 100*(exp(alpha_1) - 1)
   p_i_Yr16 <- 100*(exp(alpha_2) - 1)
   p_i_Yr17 <- 100*(exp(alpha_3) - 1)
   p_i_Yr18 <- 100*(exp(alpha_4) - 1)
   p_i_Yr19 <- 100*(exp(alpha_5) - 1)
   p_i_Yr20 <- 100*(exp(alpha_6) - 1)
   p_i_UsPres <- 100*(exp(alpha_7) - 1)
   p_i_ChinaEmp <- 100*(exp(alpha_8) - 1)
   p_i_DalaiLama <- 100*(exp(alpha_9) - 1)
   p_i_JapanEmp <- 100*(exp(alpha_10) - 1)

   p_i_Yr15ChinaEmp <- 100*(exp(alpha_1_8) - 1)
   p_i_Yr15DalaiLama <- 100*(exp(alpha_1_9) - 1)
   p_i_Yr15JapanEmp <- 100*(exp(alpha_1_10) - 1)

   p_i_Yr16ChinaEmp <- 100*(exp(alpha_2_8) - 1)
   p_i_Yr16DalaiLama <- 100*(exp(alpha_2_9) - 1)
   p_i_Yr16JapanEmp <- 100*(exp(alpha_2_10) - 1)


   p_i_Yr17ChinaEmp <- 100*(exp(alpha_3_8) - 1)
   p_i_Yr17DalaiLama <- 100*(exp(alpha_3_9) - 1)
   p_i_Yr17JapanEmp <- 100*(exp(alpha_3_10) - 1)

   p_i_Yr18UsPres <- 100*(exp(alpha_4_7) - 1)
   p_i_Yr18ChinaEmp <- 100*(exp(alpha_4_8) - 1)
   p_i_Yr18DalaiLama <- 100*(exp(alpha_4_9) - 1)
   p_i_Yr18JapanEmp <- 100*(exp(alpha_4_10) - 1)

   p_i_Yr19UsPres <- 100*(exp(alpha_5_7) - 1)
   p_i_Yr19ChinaEmp <- 100*(exp(alpha_5_8) - 1)
   p_i_Yr19DalaiLama <- 100*(exp(alpha_5_9) - 1)
   p_i_Yr19JapanEmp <- 100*(exp(alpha_5_10) - 1)

   p_i_Yr20UsPres <- 100*(exp(alpha_6_7) - 1)
   p_i_Yr20ChinaEmp <- 100*(exp(alpha_6_8) - 1)
   p_i_Yr20DalaiLama <- 100*(exp(alpha_6_9) - 1)
   p_i_Yr20JapanEmp <- 100*(exp(alpha_6_10) - 1)


  # Predictive distribution of age at the new values (i.e. 10 alive leaders)
  beta_Francis <- beta_0 + beta_6
  mu_Francis <- exp(beta_Francis)
  survival_Francis ~ dweib(r, mu_Francis) %_% T(present_length_Francis, upper_length)
  age_Francis_predictive <- survival_Francis

  beta_Obama <- beta_0 + beta_6 + beta_7 + beta_6_7
  mu_Obama <- exp(beta_Obama)
  survival_Obama ~ dweib(r, mu_Obama) %_% T(present_length_Obama, upper_length)
  age_Obama_predictive <- survival_Obama

  beta_Dalai <- beta_0 + beta_6 + beta_10 + beta_6_10
  mu_Dalai <- exp(beta_Dalai)
  survival_Dalai ~ dweib(r, mu_Dalai) %_% T(present_length_Dalai, upper_length)
  age_Dalai_predictive <- survival_Dalai

  beta_Naruhito <- beta_0 + beta_6 + beta_9 + beta_6_9
  mu_Naruhito <- exp(beta_Naruhito)
  survival_Naruhito ~ dweib(r, mu_Naruhito) %_% T(present_length_Naruhito, upper_length)
  age_Naruhito_predictive <- survival_Naruhito

  beta_Benedict <- beta_0 + beta_6
  mu_Benedict <- exp(beta_Benedict)
  survival_Benedict ~ dweib(r, mu_Benedict) %_% T(present_length_Benedict, upper_length)
  age_Benedict_predictive <- survival_Benedict

  beta_Carter <- beta_0 + beta_6 + beta_7 + beta_6_7
  mu_Carter <- exp(beta_Carter)
  survival_Carter ~ dweib(r, mu_Carter) %_% T(present_length_Carter, upper_length)
  age_Carter_predictive <- survival_Carter

  beta_Clinton <- beta_0 + beta_6 + beta_7 + beta_6_7
  mu_Clinton <- exp(beta_Clinton)
  survival_Clinton ~ dweib(r, mu_Clinton) %_% T(present_length_Clinton, upper_length)
  age_Clinton_predictive <- survival_Clinton

  beta_Bush <- beta_0 + beta_6 + beta_7 + beta_6_7
  mu_Bush <- exp(beta_Bush)
  survival_Bush ~ dweib(r, mu_Bush) %_% T(present_length_Bush, upper_length)
  age_Bush_predictive <- survival_Bush

  beta_Trump <- beta_0 + beta_6 + beta_7 + beta_6_7
  mu_Trump <- exp(beta_Trump)
  survival_Trump ~ dweib(r, mu_Trump) %_% T(present_length_Trump, upper_length)
  age_Trump_predictive <- survival_Trump

  beta_Akihito <- beta_0 + beta_6 + beta_9 + beta_6_9
  mu_Akihito <- exp(beta_Naruhito)
  survival_Akihito ~ dweib(r, mu_Akihito) %_% T(present_length_Akihito, upper_length)
  age_Akihito_predictive <- survival_Akihito

 }
```

```{r, input-list, include = FALSE}
censored_dex = which(censored==1) # index of ppl who are censored

# set numeric vectors for censored ppl
z_censored <- rep(0, length(censored_dex))
t_censored <- censoring_limits[censored_dex]
x_1_censored <- x_1[censored_dex] 
x_2_censored <- x_2[censored_dex] 
x_3_censored <- x_3[censored_dex]
x_4_censored <- x_4[censored_dex]
x_5_censored <- x_5[censored_dex]
x_6_censored <- x_6[censored_dex]
x_7_censored <- x_7[censored_dex]
x_8_censored <- x_8[censored_dex]
x_9_censored <- x_9[censored_dex]
x_10_censored <- x_10[censored_dex] 

x_1_8_censored <- x_1_8[censored_dex] 
x_1_9_censored <- x_1_9[censored_dex] 
x_1_10_censored <- x_1_10[censored_dex] 

x_2_8_censored <- x_2_8[censored_dex] 
x_2_9_censored <- x_2_9[censored_dex] 
x_2_10_censored <- x_2_10[censored_dex] 


x_3_8_censored <- x_3_8[censored_dex] 
x_3_9_censored <- x_3_9[censored_dex] 
x_3_10_censored <- x_3_10[censored_dex] 

x_4_7_censored <- x_4_7[censored_dex] 
x_4_8_censored <- x_4_8[censored_dex] 
x_4_9_censored <- x_4_9[censored_dex] 
x_4_10_censored <- x_4_10[censored_dex] 

x_5_7_censored <- x_5_7[censored_dex] 
x_5_8_censored <- x_5_8[censored_dex] 
x_5_9_censored <- x_5_9[censored_dex] 
x_5_10_censored <- x_5_10[censored_dex] 

x_6_7_censored <- x_6_7[censored_dex] 
x_6_8_censored <- x_6_8[censored_dex] 
x_6_9_censored <- x_6_9[censored_dex] 
x_6_10_censored <- x_6_10[censored_dex] 

n_censored <- length(censored_dex)

# set numeric vectors for non censored ppl
survival_non_censored <- survival[-censored_dex] # Remove ALL ALIVE PEOPLE
x_1_non_censored <- x_1[-censored_dex]
x_2_non_censored <- x_2[-censored_dex]
x_3_non_censored <- x_3[-censored_dex]
x_4_non_censored <- x_4[-censored_dex]
x_5_non_censored <- x_5[-censored_dex]
x_6_non_censored <- x_6[-censored_dex]
x_7_non_censored <- x_7[-censored_dex]
x_8_non_censored <- x_8[-censored_dex]
x_9_non_censored <- x_9[-censored_dex]
x_10_non_censored <- x_10[-censored_dex]

x_1_8_non_censored <- x_1_8[-censored_dex] 
x_1_9_non_censored <- x_1_9[-censored_dex] 
x_1_10_non_censored <- x_1_10[-censored_dex] 

x_2_8_non_censored <- x_2_8[-censored_dex] 
x_2_9_non_censored <- x_2_9[-censored_dex] 
x_2_10_non_censored <- x_2_10[-censored_dex] 


x_3_8_non_censored <- x_3_8[-censored_dex] 
x_3_9_non_censored <- x_3_9[-censored_dex] 
x_3_10_non_censored <- x_3_10[-censored_dex] 

x_4_7_non_censored <- x_4_7[-censored_dex] 
x_4_8_non_censored <- x_4_8[-censored_dex] 
x_4_9_non_censored <- x_4_9[-censored_dex] 
x_4_10_non_censored <- x_4_10[-censored_dex] 

x_5_7_non_censored <- x_5_7[-censored_dex] 
x_5_8_non_censored <- x_5_8[-censored_dex] 
x_5_9_non_censored <- x_5_9[-censored_dex] 
x_5_10_non_censored <- x_5_10[-censored_dex] 

x_6_7_non_censored <- x_6_7[-censored_dex] 
x_6_8_non_censored <- x_6_8[-censored_dex] 
x_6_9_non_censored <- x_6_9[-censored_dex] 
x_6_10_non_censored <- x_6_10[-censored_dex] 

n_non_censored <- length(survival_non_censored)

# find attributes for the 10 alive leaders
birth_year_Francis <- leaders_data$Birth.Year[leaders_data$Name == "Francis"]
year_Francis <- birth_year_Francis - mean(leaders_nopred$Birth.Year)
present_length_Francis <- leaders_data$Age.Event[leaders_data$Name =="Francis"]

birth_year_Obama <- leaders_data$Birth.Year[leaders_data$Name == "Barack Obama"]
year_Obama <- birth_year_Obama - mean(leaders_nopred$Birth.Year)
present_length_Obama <- leaders_data$Age.Event[leaders_data$Name =="Barack Obama"]

birth_year_Dalai <- leaders_data$Birth.Year[leaders_data$Name == "14th Dalai Lama (Tenzin Gyatso)"]
year_Dalai <- birth_year_Dalai - mean(leaders_nopred$Birth.Year)
present_length_Dalai <- leaders_data$Age.Event[leaders_data$Name =="14th Dalai Lama (Tenzin Gyatso)"]

birth_year_Naruhito <- leaders_data$Birth.Year[leaders_data$Name == "Naruhito (Emperor Reiwa)"]
year_Naruhito <- birth_year_Naruhito - mean(leaders_nopred$Birth.Year)
present_length_Naruhito <- leaders_data$Age.Event[leaders_data$Name =="Naruhito (Emperor Reiwa)"]

birth_year_Benedict <- leaders_data$Birth.Year[leaders_data$Name == "Benedict XVI)"]
year_Benedict <- birth_year_Benedict - mean(leaders_nopred$Birth.Year)
present_length_Benedict <- leaders_data$Age.Event[leaders_data$Name =="Benedict XVI"]

birth_year_Carter <- leaders_data$Birth.Year[leaders_data$Name == "Jimmy Carter"]
year_Carter <- birth_year_Carter - mean(leaders_nopred$Birth.Year)
present_length_Carter <- leaders_data$Age.Event[leaders_data$Name =="Jimmy Carter"]

birth_year_Clinton <- leaders_data$Birth.Year[leaders_data$Name == "Bill Clinton"]
year_Clinton <- birth_year_Clinton - mean(leaders_nopred$Birth.Year)
present_length_Clinton <- leaders_data$Age.Event[leaders_data$Name =="Bill Clinton"]

birth_year_Bush <- leaders_data$Birth.Year[leaders_data$Name == "George W. Bush"]
year_Bush <- birth_year_Bush - mean(leaders_nopred$Birth.Year)
present_length_Bush <- leaders_data$Age.Event[leaders_data$Name =="George W. Bush"]

birth_year_Trump <- leaders_data$Birth.Year[leaders_data$Name == "Donald Trump"]
year_Trump <- birth_year_Trump - mean(leaders_nopred$Birth.Year)
present_length_Trump <- leaders_data$Age.Event[leaders_data$Name =="Donald Trump"]

birth_year_Akihito <- leaders_data$Birth.Year[leaders_data$Name == "Akihito (Emperor Heisei)"]
year_Akihito <- birth_year_Akihito - mean(leaders_nopred$Birth.Year)
present_length_Akihito <- leaders_data$Age.Event[leaders_data$Name =="Akihito (Emperor Heisei)"]

upper_length <- 100

# build model inputs and run model
data_build_model <- list("n_censored", "n_non_censored", "z_censored", "t_censored",
"x_1_censored", "x_2_censored", "x_3_censored", "x_4_censored", "x_5_censored", "x_6_censored", "x_7_censored", "x_8_censored", "x_9_censored", "x_10_censored", "x_1_8_censored", "x_1_9_censored", "x_1_10_censored", "x_2_8_censored", "x_2_9_censored", "x_2_10_censored", "x_3_8_censored", "x_3_9_censored", "x_3_10_censored",  "x_4_7_censored", "x_4_8_censored", "x_4_9_censored", "x_4_10_censored",
"x_5_7_censored", "x_5_8_censored", "x_5_9_censored", "x_5_10_censored","x_6_7_censored", "x_6_8_censored", "x_6_9_censored", "x_6_10_censored","survival_non_censored", "x_1_non_censored", "x_2_non_censored", "x_3_non_censored", "x_4_non_censored", "x_5_non_censored", "x_6_non_censored", "x_7_non_censored", "x_8_non_censored", "x_9_non_censored", "x_10_non_censored", "x_1_8_non_censored", "x_1_9_non_censored", "x_1_10_non_censored",  "x_2_8_non_censored", "x_2_9_non_censored", "x_2_10_non_censored",  "x_3_8_non_censored", "x_3_9_non_censored", "x_3_10_non_censored",  "x_4_7_non_censored", "x_4_8_non_censored", "x_4_9_non_censored", "x_4_10_non_censored",   "x_5_7_non_censored", "x_5_8_non_censored", "x_5_9_non_censored", "x_5_10_non_censored",  "x_6_7_non_censored", "x_6_8_non_censored", "x_6_9_non_censored", "x_6_10_non_censored",  "present_length_Francis", "present_length_Obama", "present_length_Dalai", "present_length_Naruhito","present_length_Benedict", "present_length_Carter", "present_length_Clinton", "present_length_Bush", "present_length_Trump", "present_length_Akihito", "upper_length")
```

```{r, output-list, include = F}
params_to_output = c("beta_0", "beta_1", "beta_2", "beta_3", "beta_4", "beta_5", "beta_6", "beta_7", "beta_8", "beta_9", "beta_10",  "beta_1_8", "beta_1_9", "beta_1_10",  "beta_2_8", "beta_2_9", "beta_2_10",  "beta_3_8", "beta_3_9", "beta_3_10", "beta_4_7", "beta_4_8", "beta_4_9", "beta_4_10",  "beta_5_7", "beta_5_8", "beta_5_9", "beta_5_10",  "beta_6_7", "beta_6_8", "beta_6_9", "beta_6_10", "r", "alpha_0", "alpha_1", "alpha_2", "alpha_3", "alpha_4", "alpha_5", "alpha_6", "alpha_7", "alpha_8", "alpha_9", "alpha_10",  "alpha_1_8", "alpha_1_9", "alpha_1_10",  "alpha_2_8", "alpha_2_9", "alpha_2_10",  "alpha_3_8", "alpha_3_9", "alpha_3_10", "alpha_4_7", "alpha_4_8", "alpha_4_9", "alpha_4_10", "alpha_5_7", "alpha_5_8", "alpha_5_9", "alpha_5_10", "alpha_6_7", "alpha_6_8", "alpha_6_9", "alpha_6_10",  "p_i_Yr15", "p_i_Yr16", "p_i_Yr17", "p_i_Yr18", "p_i_Yr19", "p_i_Yr20",  "p_i_UsPres", "p_i_ChinaEmp", "p_i_DalaiLama", "p_i_JapanEmp", "p_i_Yr15ChinaEmp", "p_i_Yr15DalaiLama", "p_i_Yr15JapanEmp",  "p_i_Yr16ChinaEmp", "p_i_Yr16DalaiLama", "p_i_Yr16JapanEmp",  "p_i_Yr17ChinaEmp",   "p_i_Yr17DalaiLama", "p_i_Yr17JapanEmp", "p_i_Yr18UsPres", "p_i_Yr18ChinaEmp",  "p_i_Yr18DalaiLama", "p_i_Yr18JapanEmp", "p_i_Yr19UsPres", "p_i_Yr19ChinaEmp", "p_i_Yr19DalaiLama", "p_i_Yr19JapanEmp", "p_i_Yr20UsPres", "p_i_Yr20ChinaEmp", "p_i_Yr20DalaiLama", "p_i_Yr20JapanEmp", "age_Francis_predictive", "age_Obama_predictive","age_Dalai_predictive", "age_Naruhito_predictive", "age_Benedict_predictive","age_Carter_predictive", "age_Clinton_predictive", "age_Bush_predictive","age_Trump_predictive","age_Akihito_predictive")
```

```{r, model-priors, include = F}
priors = "
  beta_0 ~ dnorm(0.0, 1.0E-3) # priors on betas are all normal w/ low precision
  beta_1 ~ dnorm(0.0, 1.0E-3) 
  beta_2 ~ dnorm(0.0, 1.0E-3) 
  beta_3 ~ dnorm(0.0, 1.0E-3) 
  beta_4 ~ dnorm(0.0, 1.0E-3) 
  beta_5 ~ dnorm(0.0, 1.0E-3) 
  beta_6 ~ dnorm(0.0, 1.0E-3) 
  beta_7 ~ dnorm(0.0, 1.0E-3) 
  beta_8 ~ dnorm(0.0, 1.0E-3) 
  beta_9 ~ dnorm(0.0, 1.0E-3) 
  beta_10 ~ dnorm(0.0, 1.0E-3) 
  beta_1_8 ~ dnorm(0.0, 1.0E-3) 
  beta_1_9 ~ dnorm(0.0, 1.0E-3) 
  beta_1_10 ~ dnorm(0.0, 1.0E-3) 

  beta_2_8 ~ dnorm(0.0, 1.0E-3) 
  beta_2_9 ~ dnorm(0.0, 1.0E-3) 
  beta_2_10 ~ dnorm(0.0, 1.0E-3) 
  
  beta_3_8 ~ dnorm(0.0, 1.0E-3) 
  beta_3_9 ~ dnorm(0.0, 1.0E-3) 
  beta_3_10 ~ dnorm(0.0, 1.0E-3) 
  beta_4_7 ~ dnorm(0.0, 1.0E-3) 
  beta_4_8 ~ dnorm(0.0, 1.0E-3) 
  beta_4_9 ~ dnorm(0.0, 1.0E-3) 
  beta_4_10 ~ dnorm(0.0, 1.0E-3) 
  beta_5_7 ~ dnorm(0.0, 1.0E-3) 
  beta_5_8 ~ dnorm(0.0, 1.0E-3) 
  beta_5_9 ~ dnorm(0.0, 1.0E-3) 
  beta_5_10 ~ dnorm(0.0, 1.0E-3) 
  beta_6_7 ~ dnorm(0.0, 1.0E-3) 
  beta_6_8 ~ dnorm(0.0, 1.0E-3) 
  beta_6_9 ~ dnorm(0.0, 1.0E-3) 
  beta_6_10 ~ dnorm(0.0, 1.0E-3) 

  r ~ dexp(0.1) # Prior on r
  "
```

```{r, write-model-text, include = F}
model_text = function(priors=""){
  file <- tempfile()
  
  likelihood = "#set up likelihood
  for(i in 1:n_censored) {
    z_censored[i] ~ dpois(phi_censored[i])
    phi_censored[i] <- mu_censored[i] * pow(t_censored[i], r)
    mu_censored[i] <- exp(beta_censored[i])
    beta_censored[i] <- beta_0 + beta_1*x_1_censored[i] +
      beta_2*x_2_censored[i] + beta_3*x_3_censored[i] + beta_4*x_4_censored[i] + beta_5*x_5_censored[i] + beta_6*x_6_censored[i] + beta_7*x_7_censored[i] + beta_8*x_8_censored[i] + beta_9*x_9_censored[i] + beta_10*x_10_censored[i] +

     beta_1_8*x_1_8_censored[i] +  beta_1_9*x_1_9_censored[i] + beta_1_10*x_1_10_censored[i] +

        
          beta_2_8*x_2_8_censored[i] +
          beta_2_9*x_2_9_censored[i] +
          beta_2_10*x_2_10_censored[i] +

          
          beta_3_8*x_3_8_censored[i] +
          beta_3_9*x_3_9_censored[i] +
          beta_3_10*x_3_10_censored[i] +

          beta_4_7*x_4_7_censored[i] +
          beta_4_8*x_4_8_censored[i] +
          beta_4_9*x_4_9_censored[i] +
          beta_4_10*x_4_10_censored[i] +

          beta_5_7*x_5_7_censored[i] +
          beta_5_8*x_5_8_censored[i] +
          beta_5_9*x_5_9_censored[i] +
          beta_5_10*x_5_10_censored[i] +

          beta_6_7*x_6_7_censored[i] +
          beta_6_8*x_6_8_censored[i] +
          beta_6_9*x_6_9_censored[i] +
          beta_6_10*x_6_10_censored[i]

  }

  for(j in 1:n_non_censored) {
    survival_non_censored[j] ~ dweib(r, mu[j])
    mu[j] <- exp(beta[j])
    beta[j] <- beta_0 + beta_1*x_1_non_censored[j] +
      beta_2*x_2_non_censored[j] + beta_3*x_3_non_censored[j] + beta_4*x_4_non_censored[j] + beta_5*x_5_non_censored[j] + beta_6*x_6_non_censored[j] + beta_7*x_7_non_censored[j] + beta_8*x_8_non_censored[j] + beta_9*x_9_non_censored[j] + beta_10*x_10_non_censored[j] 

     + beta_1_8*x_1_8_non_censored[j] +  beta_1_9*x_1_9_non_censored[j] + beta_1_10*x_1_10_non_censored[j] +

        
          beta_2_8*x_2_8_non_censored[j] +
          beta_2_9*x_2_9_non_censored[j] +
          beta_2_10*x_2_10_non_censored[j] +

        
          beta_3_8*x_3_8_non_censored[j] +
          beta_3_9*x_3_9_non_censored[j] +
          beta_3_10*x_3_10_non_censored[j] +

          beta_4_7*x_4_7_non_censored[j] +
          beta_4_8*x_4_8_non_censored[j] +
          beta_4_9*x_4_9_non_censored[j] +
          beta_4_10*x_4_10_non_censored[j] +

          beta_5_7*x_5_7_non_censored[j] +
          beta_5_8*x_5_8_non_censored[j] +
          beta_5_9*x_5_9_non_censored[j] +
          beta_5_10*x_5_10_non_censored[j] +

          beta_6_7*x_6_7_non_censored[j] +
          beta_6_8*x_6_8_non_censored[j] +
          beta_6_9*x_6_9_non_censored[j] +
          beta_6_10*x_6_10_non_censored[j]
  }
  "
  
  alphas_percentage_pred = "# set up alphas and percentages for interpret
  # define alphas
  alpha_0 <- - beta_0 / r
  alpha_1 <- - beta_1 / r
  alpha_2 <- - beta_2 / r
  alpha_3 <- - beta_3 / r
  alpha_4 <- - beta_4 / r
  alpha_5 <- - beta_5 / r
  alpha_6 <- - beta_6 / r
  alpha_7 <- - beta_7 / r
  alpha_8 <- - beta_8 / r
  alpha_9 <- - beta_9 / r
  alpha_10 <- - beta_10 / r
  
 
  alpha_1_8 <- - beta_1_8 / r
  alpha_1_9 <- - beta_1_9 / r
  alpha_1_10 <- - beta_1_10 / r

  
  alpha_2_8 <- - beta_2_8 / r
  alpha_2_9 <- - beta_2_9 / r
  alpha_2_10 <- - beta_2_10 / r

 
  alpha_3_8 <- - beta_3_8 / r
  alpha_3_9 <- - beta_3_9 / r
  alpha_3_10 <- - beta_3_10 / r

  alpha_4_7 <- - beta_4_7 / r
  alpha_4_8 <- - beta_4_8 / r
  alpha_4_9 <- - beta_4_9 / r
  alpha_4_10 <- - beta_4_10 / r

  alpha_5_7 <- - beta_5_7 / r
  alpha_5_8 <- - beta_5_8 / r
  alpha_5_9 <- - beta_5_9 / r
  alpha_5_10 <- - beta_5_10 / r

  alpha_6_7 <- - beta_6_7 / r
  alpha_6_8 <- - beta_6_8 / r
  alpha_6_9 <- - beta_6_9 / r
  alpha_6_10 <- - beta_6_10 / r


  # Percentage increases
  p_i_Yr15 <- 100*(exp(alpha_1) - 1)
  p_i_Yr16 <- 100*(exp(alpha_2) - 1)
  p_i_Yr17 <- 100*(exp(alpha_3) - 1)
  p_i_Yr18 <- 100*(exp(alpha_4) - 1)
  p_i_Yr19 <- 100*(exp(alpha_5) - 1)
  p_i_Yr20 <- 100*(exp(alpha_6) - 1)
  p_i_UsPres <- 100*(exp(alpha_7) - 1)
  p_i_ChinaEmp <- 100*(exp(alpha_8) - 1)
  p_i_DalaiLama <- 100*(exp(alpha_9) - 1)
  p_i_JapanEmp <- 100*(exp(alpha_10) - 1)

  p_i_Yr15ChinaEmp <- 100*(exp(alpha_1_8) - 1)
  p_i_Yr15DalaiLama <- 100*(exp(alpha_1_9) - 1)
  p_i_Yr15JapanEmp <- 100*(exp(alpha_1_10) - 1)

  
  p_i_Yr16ChinaEmp <- 100*(exp(alpha_2_8) - 1)
  p_i_Yr16DalaiLama <- 100*(exp(alpha_2_9) - 1)
  p_i_Yr16JapanEmp <- 100*(exp(alpha_2_10) - 1)

 
  p_i_Yr17ChinaEmp <- 100*(exp(alpha_3_8) - 1)
  p_i_Yr17DalaiLama <- 100*(exp(alpha_3_9) - 1)
  p_i_Yr17JapanEmp <- 100*(exp(alpha_3_10) - 1)

  p_i_Yr18UsPres <- 100*(exp(alpha_4_7) - 1)
  p_i_Yr18ChinaEmp <- 100*(exp(alpha_4_8) - 1)
  p_i_Yr18DalaiLama <- 100*(exp(alpha_4_9) - 1)
  p_i_Yr18JapanEmp <- 100*(exp(alpha_4_10) - 1)

  p_i_Yr19UsPres <- 100*(exp(alpha_5_7) - 1)
  p_i_Yr19ChinaEmp <- 100*(exp(alpha_5_8) - 1)
  p_i_Yr19DalaiLama <- 100*(exp(alpha_5_9) - 1)
  p_i_Yr19JapanEmp <- 100*(exp(alpha_5_10) - 1)

  p_i_Yr20UsPres <- 100*(exp(alpha_6_7) - 1)
  p_i_Yr20ChinaEmp <- 100*(exp(alpha_6_8) - 1)
  p_i_Yr20DalaiLama <- 100*(exp(alpha_6_9) - 1)
  p_i_Yr20JapanEmp <- 100*(exp(alpha_6_10) - 1)

  # Predictive distribution of age at the new values
  beta_Francis <- beta_0 + beta_6
  mu_Francis <- exp(beta_Francis)
  survival_Francis ~ dweib(r, mu_Francis)T(present_length_Francis, upper_length)
  age_Francis_predictive <- survival_Francis

  beta_Obama <- beta_0 + beta_6 + beta_7 + beta_6_7
  mu_Obama <- exp(beta_Obama)
  survival_Obama ~ dweib(r, mu_Obama)T(present_length_Obama, upper_length)
  age_Obama_predictive <- survival_Obama
  
  beta_Dalai <- beta_0 + beta_6 + beta_10 + beta_6_10
  mu_Dalai <- exp(beta_Dalai)
  survival_Dalai ~ dweib(r, mu_Dalai)T(present_length_Dalai, upper_length)
  age_Dalai_predictive <- survival_Dalai

  beta_Naruhito <- beta_0 + beta_6 + beta_9 + beta_6_9
  mu_Naruhito <- exp(beta_Naruhito)
  survival_Naruhito ~ dweib(r, mu_Naruhito)T(present_length_Naruhito, upper_length)
  age_Naruhito_predictive <- survival_Naruhito

  beta_Benedict <- beta_0 + beta_6
  mu_Benedict <- exp(beta_Benedict)
  survival_Benedict ~ dweib(r, mu_Benedict)T(present_length_Benedict, upper_length)
  age_Benedict_predictive <- survival_Benedict

  beta_Carter <- beta_0 + beta_6 + beta_7 + beta_6_7
  mu_Carter <- exp(beta_Carter)
  survival_Carter ~ dweib(r, mu_Carter)T(present_length_Carter, upper_length)
  age_Carter_predictive <- survival_Carter

  beta_Clinton <- beta_0 + beta_6 + beta_7 + beta_6_7
  mu_Clinton <- exp(beta_Clinton)
  survival_Clinton ~ dweib(r, mu_Clinton)T(present_length_Clinton, upper_length)
  age_Clinton_predictive <- survival_Clinton

  beta_Bush <- beta_0 + beta_6 + beta_7 + beta_6_7
  mu_Bush <- exp(beta_Bush)
  survival_Bush ~ dweib(r, mu_Bush)T(present_length_Bush, upper_length)
  age_Bush_predictive <- survival_Bush

  beta_Trump <- beta_0 + beta_6 + beta_7 + beta_6_7
  mu_Trump <- exp(beta_Trump)
  survival_Trump ~ dweib(r, mu_Trump)T(present_length_Trump, upper_length)
  age_Trump_predictive <- survival_Trump

  beta_Akihito <- beta_0 + beta_6 + beta_9 + beta_6_9
  mu_Akihito <- exp(beta_Naruhito)
  survival_Akihito ~ dweib(r, mu_Akihito)T(present_length_Akihito, upper_length)
  age_Akihito_predictive <- survival_Akihito
  "
  
  model_text <- paste("model{ ", likelihood, priors, alphas_percentage_pred, "}")
  writeLines(model_text,con=file)
  return(file)
}
```

```{r, run-model-function, include = F}
run_model = function(priors, name) {
  file <- model_text(priors)
  if (file.exists(name)) {
    load(file = name)
  } else {
    model_output <- jags(data = data_build_model,
                         parameters.to.save =  params_to_output,
                         n.iter = 50000,
                         n.chains = 3,
                         model.file = file)
    save(model_output, file = name)
  }
  return(model_output)
}

model_output = run_model(priors, "model_used_in_paper") 

#model_output
```

# IV. Analysis

As Stander et al (2018) pointed out, following this Weibull distribution, $\log(T) = \frac{1}{r}(\mu)+\frac{1}{r}(\epsilon)$, or

$$\log(T) \sim -\frac{1}{r} (\beta_0 + \beta_1x_1+\cdots+\beta_6x_6+\beta_7x_7+\cdots\beta_{10}x_{10}+\beta_{1,8}x_1x_8+\cdots+\beta_{6,10}x_6x_{10}) +\frac{1}{r}\log(\epsilon) \\
\ \ \ \ \ \ \ \ \ \ \ \ \ \ = \alpha_0 + \alpha_1x_1+\cdots+\alpha_6x_6+\alpha_7x_7+\cdots\alpha_{10}x_{10}+\alpha_{1,8}x_1x_8+\cdots+\alpha_{6,10}x_6x_{10}) +\frac{1}{r}\log(\epsilon)$$

where $\epsilon \sim exp(1)$ and $\epsilon > 0$. $\alpha = -\beta/r$ is thus a monotone transformation of $\beta$. $x_1,\cdots,x_6$ are indicator values (i.e., 0s and 1s) corresponding to birth year's century, and $x_7,\cdots,x_{10}$ are indicator values corresponding to types of leadership.

The interpretation of coefficients depends on the interaction terms (i.e. both birth year century and the types of leadership). For example, while keeping all else constant, if a Pope was born in the 20th century, he is expected to live longer by a multiplicative factor of $exp(\alpha_6)$ compared to a Pope born in the 14th century, or his lifespan is expected to increase by a percentage of $100*exp(\alpha_6-1)$. If a U.S. President was born in the 18th century, he is expected to live $exp(\alpha_0+\alpha_4+\alpha_7+\alpha_{4,7})$ years; if the president were born in the 20th century instead, he is expected to live $exp(\alpha_0+\alpha_6+\alpha_7+\alpha_{6,7})$ years. In other words, his lifespan is expected to increase by a multiplicative factor of $exp(\alpha_6-\alpha_4+\alpha_{6,7}-\alpha_{4,7})$. If a Chinese Emperor and a Dalai Lama were both born in the 19th century, the Chinese emperor is expected to live longer by a multiplicative factor of $exp(\alpha_8 - \alpha_9 + \alpha_{5,8}-\alpha_{5,9})$ and so on. 

# V. Results

## V a. Output and Interpretation of the Model

The table below shows the model output of the multiplicative factors, $\alpha$s. Note that since $\alpha = -\beta/r$ is a monotone transformation, if $\beta$ is statistically significant (i.e. 95% credible interval doesn't contain 0), it should be the same for the corresponding $\alpha$. 

```{r tidy-model-table-alpha, echo = F}
# table of multiplicative factor (alphas)
vars1 = c("alpha_0", "alpha_1", "alpha_10", "alpha_1_10", "alpha_1_8", "alpha_1_9", 
          "alpha_2", "alpha_2_10", "alpha_2_8", "alpha_2_9", 
          "alpha_3", "alpha_3_10", "alpha_3_8", "alpha_3_9", 
          "alpha_4", "alpha_4_10", "alpha_4_7", "alpha_4_8", "alpha_4_9", 
          "alpha_5", "alpha_5_10", "alpha_5_7", "alpha_5_8", "alpha_5_9", 
          "alpha_6", "alpha_6_10", "alpha_6_7", "alpha_6_8", "alpha_6_9", 
          "alpha_7", "alpha_8", "alpha_9")
vars1name = c("Intercept", "Born in 15th Century", "Japanese Emperor", "15th Century*Japanese Emperor", "15th Century*Chinese Emperor", "15th Century*Dalai Lama", 
          "Born in 16th Century", "16th Century*Japanese Emperor", "16th Century*Chinese Emperor", "16th Century*Dalai Lama",
          "Born in 17th Century", "17th Century*Japanese Emperor", "17th Century*Chinese Emperor", "17th Century*Dalai Lama",
          "Born in 18th Century", "18th Century*Japanese Emperor", "18th Century*U.S. President", "18th Century*Chinese Emperor", "18th Century*Dalai Lama", 
          "Born in 19th Century", "19th Century*Japanese Emperor", "19th Century*U.S. President", "19th Century*Chinese Emperor", "19th Century*Dalai Lama", 
          "Born in 20th Century", "20th Century*Japanese Emperor", "20th Century*U.S. President", "20th Century*Chinese Emperor", "20th Century*Dalai Lama",
          "U.S. President", "Chinese Emperor","Dalai Lama")
num = c(1,2,11,14,12,13,3,17,15,16,4,20,18,19,5,24,21,22,23,6,28,25,26,27,7,32,29,30,31,8,9,10)

output <- data.frame(model_output$BUGSoutput$summary)
output <- output[row.names(output) %in% vars1, ]
coef_alpha <- output %>%
  mutate("Coefficient" = vars1,
         "Coefficient Name" = vars1name,
         "Mean" = output$mean,
         "Standard Deviation" = output$sd,
         "2.5% Quantile" = output$X2.5.,
         "Median" = output$X50.,
         "97.5% Quantile" = output$X97.5.,
         num = num
         ) %>%
  arrange(num) %>%
  select("Coefficient", "Coefficient Name", "Mean", "Standard Deviation", "2.5% Quantile", "Median", "97.5% Quantile")

kable(coef_alpha, digits = 2)
```
*double check variable significance after knitting the whole document*

Since the baseline for comparison is a Pope born in the 14th century, it's meaningful to interpret the intercept in this case. The intercept shows that we expect a Pope born in the 14th century to live exp($\alpha_0$) = exp(`r round(coef_alpha[1,3],1)`) = `r round(exp(coef_alpha[1,3]),1)` years. $\alpha_{6,9}$ which corresponds to the interaction between born in the 20th century and being a Dalai Lama has an abnormally large point estimate, largely because there is only one Dalai Lamai born the last century and he is a censored data point. 

While $\alpha_1, \cdots,\alpha_5$ have 95% credible intervals containing 0 (an indication that these coefficients are statistically insignificant), $\alpha_6$ has a positive 95% credible interval. Hence birth year overall is an significant predictor in this model. If we only look at the main effect of leadership types ($\alpha_7, \cdots,\alpha_10$), these parameters' 95% credible intervals all contain 0. However, some of their interactions with birth year are statistically significant, for example, $\alpha_{1,8}$'s CI is always negative. Due to model hierarchy, we need to keep main effects of leadership types in the model as well. 

The specific interpretation of these parameters depends on inputs from birth year and type of leadership. Below are some examples. 

- A Japanese emperor born in different centuries
    + 14th century: $\log(T_{14th,JapanEmp}) = \alpha_0+\alpha_{10}+\frac{1}{r}\log(\epsilon)$
    + 15th century: $\log(T_{15th,JapanEmp}) = \alpha_0+\alpha_1+\alpha_{10}+\alpha_{1,10}+\frac{1}{r}\log(\epsilon)$
    + 16th century: $\log(T_{16th,JapanEmp}) = \alpha_0+\alpha_2+\alpha_{10}+\alpha_{2,10}+\frac{1}{r}\log(\epsilon)$
    + 17th century: $\log(T_{17th,JapanEmp}) = \alpha_0+\alpha_3+\alpha_{10}+\alpha_{3,10}+\frac{1}{r}\log(\epsilon)$
    + 18th century: $\log(T_{18th,JapanEmp}) = \alpha_0+\alpha_4+\alpha_{10}+\alpha_{4,10}+\frac{1}{r}\log(\epsilon)$
    + 19th century: $\log(T_{19th,JapanEmp}) = \alpha_0+\alpha_5+\alpha_{10}+\alpha_{5,10}+\frac{1}{r}\log(\epsilon)$
    + 20th century: $\log(T_{20th,JapanEmp}) = \alpha_0+\alpha_6+\alpha_{10}+\alpha_{6,10}+\frac{1}{r}\log(\epsilon)$

The summary table is shown below if we compare the expected lifespans of later Japanese emperors with that of a Japanese emperor born in the 14th century. 
```{r, echo=F}
leader_vec <- c("Born in 14th Century","Born in 15th Century", "Born in 16th Century", "Born in 17th Century", "Born in 18th Century", "Born in 19th Century", "Born in 20th Century")
alpha_vals<- c(0, coef_alpha[2,3] + coef_alpha[14,3], coef_alpha[3,3]+coef_alpha[17,3], coef_alpha[4,3]+coef_alpha[20,3], coef_alpha[5,3]+coef_alpha[24,3], coef_alpha[6,3]+coef_alpha[28,3],coef_alpha[7,3]+coef_alpha[32,3])
multiplicative_factor <- round(exp(alpha_vals),2)
perc_increase <- round(100*(multiplicative_factor-1),1)

JapanEmp_diff_time <- data.frame(leader_vec) %>%
  mutate("Japanese Emperor" = leader_vec,
         "Multiplicative Factor" = multiplicative_factor,
         "% Increase / Decrease in Lifespan" = perc_increase) %>%
  select("Japanese Emperor","Multiplicative Factor","% Increase / Decrease in Lifespan")
kable(JapanEmp_diff_time)
```
Surprisingly, the model suggests that longevity doesn't always increase with calendar time. The biggest increase in lifespan is in the 20th century, where the expected lifespan of a Japanese emperor increases by `r JapanEmp_diff_time[7,3]`% compared to a Japanese emperor born 6 centuries ago. This might make sense, given the last century saw the biggest number of technological breakthroughs and improvement in healthcare.   

- Dalai Lamai born in different centuries
    + 14th century: $\log(T_{14th,Dalai}) = \alpha_0+\alpha_9+\frac{1}{r}\log(\epsilon)$
    + 15th century: $\log(T_{15th,Dalai}) = \alpha_0+\alpha_1+\alpha_9+\alpha_{1,9}+\frac{1}{r}\log(\epsilon)$
    + 16th century: $\log(T_{16th,Dalai}) = \alpha_0+\alpha_2+\alpha_9+\alpha_{2,9}+\frac{1}{r}\log(\epsilon)$
    + 17th century: $\log(T_{17th,Dalai}) = \alpha_0+\alpha_3+\alpha_9+\alpha_{3,9}+\frac{1}{r}\log(\epsilon)$
    + 18th century: $\log(T_{18th,Dalai}) = \alpha_0+\alpha_4+\alpha_9+\alpha_{4,9}+\frac{1}{r}\log(\epsilon)$
    + 19th century: $\log(T_{19th,Dalai}) = \alpha_0+\alpha_5+\alpha_9+\alpha_{5,9}+\frac{1}{r}\log(\epsilon)$
    + 20th century: $\log(T_{20th,Dalai}) = \alpha_0+\alpha_6+\alpha_9+\alpha_{6,9}+\frac{1}{r}\log(\epsilon)$
```{r, echo=F}
leader_vec <- c("Born in 14th Century","Born in 15th Century", "Born in 16th Century", "Born in 17th Century", "Born in 18th Century", "Born in 19th Century", "Born in 20th Century")
alpha_vals<- c(0, coef_alpha[2,3] + coef_alpha[13,3], coef_alpha[3,3]+coef_alpha[16,3], coef_alpha[4,3]+coef_alpha[19,3], coef_alpha[5,3]+coef_alpha[23,3], coef_alpha[6,3]+coef_alpha[27,3],coef_alpha[7,3]+coef_alpha[31,3])
multiplicative_factor <- round(exp(alpha_vals),2)
perc_increase <- round(100*(multiplicative_factor-1),1)

Dalai_diff_time <- data.frame(leader_vec) %>%
  mutate("Dalai Lama" = leader_vec,
         "Multiplicative Factor" = multiplicative_factor,
         "% Increase / Decrease in Lifespan" = perc_increase) %>%
  select("Dalai Lama","Multiplicative Factor","% Increase / Decrease in Lifespan")
kable(Dalai_diff_time)
```
For Dalai Lamas, percentage increase in lifespan becomes generally more negative, which means later born Dalai Lamas are expected to live shorter, confirming the negative correlation between lifespan and birth year exihibited in Figure 1 of section II.b EDA. The Dalai Lama born in the 20th century, however, is expected to live abnormally longer than the 14th Dalai Lama, due to the extremely large point estimate of $\alpha_{6,9}$ that corresponds to the interaction between born in the 20th century and being a Dalai Lama. As explained earlier, this might be because there is only one Dalai Lama born in the 20th century and he is censored. 


- Leaders born in the 18th century
   + Pope: $\log(T_{18th,Pope}) = \alpha_0+\alpha_4+\frac{1}{r}\log(\epsilon)$
   + U.S. President: $\log(T_{18th,UsPres}) = \alpha_0+\alpha_4+\alpha_7+\alpha_{4,7}+\frac{1}{r}\log(\epsilon)$
   + Chinese Emperor: $\log(T_{18th,ChinaEmp}) = \alpha_0+\alpha_4+\alpha_8+\alpha_{4,8}+\frac{1}{r}\log(\epsilon)$
   + Dalai Lama: $\log(T_{18th,Dalai}) = \alpha_0+\alpha_4+\alpha_9+\alpha_{4,9}+\frac{1}{r}\log(\epsilon)$
   + Japanese Emperor: $\log(T_{18th,JapanEmp}) = \alpha_0+\alpha_4+\alpha_{10}+\alpha_{4,10}+\frac{1}{r}\log(\epsilon)$
   
```{r, echo=F}
# different types of leaders born in the 18th century
leader_vec <- c("Pope","U.S. President", "Chinese Emperor", "Dalai Lama", "Japanese Emperor")
alpha_vals<- c(0, coef_alpha[8,3]+coef_alpha[21,3], coef_alpha[9,3]+coef_alpha[22,3], coef_alpha[10,3]+coef_alpha[23,3], coef_alpha[11,3]+coef_alpha[24,3])
multiplicative_factor <- round(exp(alpha_vals),2)
perc_increase <- round(100*(multiplicative_factor-1),1)

diff_leaders_18 <- data.frame(leader_vec) %>%
  mutate("Leaders born in 18th Century" = leader_vec,
         "Multiplicative Factor" = multiplicative_factor,
         "% Increase / Decrease in Lifespan" = perc_increase) %>%
  select("Leaders born in 18th Century","Multiplicative Factor","% Increase / Decrease in Lifespan")
kable(diff_leaders_18)
```

- Leaders born in the 19th century
   + Pope: $\log(T_{20th,Pope}) = \alpha_0+\alpha_5+\frac{1}{r}\log(\epsilon)$
   + U.S. President: $\log(T_{20th,UsPres}) = \alpha_0+\alpha_5+\alpha_7+\alpha_{5,7}+\frac{1}{r}\log(\epsilon)$
   + Chinese Emperor: $\log(T_{20th,ChinaEmp}) = \alpha_0+\alpha_5+\alpha_8+\alpha_{5,8}+\frac{1}{r}\log(\epsilon)$
   + Dalai Lama: $\log(T_{20th,Dalai}) = \alpha_0+\alpha_5+\alpha_9+\alpha_{5,9}+\frac{1}{r}\log(\epsilon)$
   + Japanese Emperor: $\log(T_{20th,JapanEmp}) = \alpha_0+\alpha_5+\alpha_{10}+\alpha_{5,10}+\frac{1}{r}\log(\epsilon)$

```{r, echo=F}
# different types of leaders born in the 19th century
leader_vec <- c("Pope","U.S. President", "Chinese Emperor", "Dalai Lama", "Japanese Emperor")
alpha_vals<- c(0, coef_alpha[8,3]+coef_alpha[25,3], coef_alpha[9,3]+coef_alpha[26,3], coef_alpha[10,3]+coef_alpha[27,3], coef_alpha[11,3]+coef_alpha[28,3])
multiplicative_factor <- round(exp(alpha_vals),2)
perc_increase <- round(100*(multiplicative_factor-1),1)

diff_leaders_20 <- data.frame(leader_vec) %>%
  mutate("Leaders born in 19th Century" = leader_vec,
         "Multiplicative Factor" = multiplicative_factor,
         "% Increase / Decrease in Lifespan" = perc_increase) %>%
  select("Leaders born in 19th Century","Multiplicative Factor","% Increase / Decrease in Lifespan")
kable(diff_leaders_20,1)
```
Popes born in the 18th and 19th century are expected to live longer than other leaders born in the same century. If born in the 18th century, a U.S. president and a Chinese emperor are expected to enjoy comparable lifespans as a Pope. However, if born in the 19th century instead, the expected lifespans of a U.S. president and a Chinese emperor are significantly shorter than that of a Pope (`r (-1)*diff_leaders_20[2,3]`% and `r (-1)*diff_leaders_20[3,3]`% shorter respectively). 

*do we need more interpretation examples?*

The table below shows the estimate and 95% credible interval (the bounds are the 2.5% quantile and 97.5% quantile) for all 10 living leaders in the dataset.

```{r, ci-table-all-living-leaders, echo = F}

# predicted lifespans for all 10 alive leaders
vars3 = c("age_Francis_predictive", "age_Obama_predictive","age_Dalai_predictive", "age_Naruhito_predictive", "age_Benedict_predictive","age_Carter_predictive", "age_Clinton_predictive", "age_Bush_predictive","age_Trump_predictive","age_Akihito_predictive")
output <- data.frame(model_output$BUGSoutput$summary)
output <- output[row.names(output) %in% vars3, ]
coef <- output %>%
  mutate("Variable" = vars3,
         "Mean" = output$mean,
         "Standard Deviation" = output$sd,
         "2.5% Quantile" = output$X2.5.,
         "Median" = output$X50.,
         "97.5% Quantile" = output$X97.5.
         ) %>%
  select("Variable", "Mean", "Standard Deviation", "2.5% Quantile","Median", "97.5% Quantile") 
kable(coef, digits = 1)
```


## V b. Posterior Inference for Selected Leaders

```{r posterior-pred-dist-prob-francisvdalai, echo = F}
all_betas = c("beta_0", "beta_1", "beta_2", "beta_3", "beta_4", "beta_5", "beta_6",
              "beta_7", "beta_8", "beta_9", "beta_10",  "beta_1_8", "beta_1_9",
              "beta_1_10",  "beta_2_8", "beta_2_9", "beta_2_10", "beta_3_8",
              "beta_3_9", "beta_3_10", "beta_4_7", "beta_4_8", "beta_4_9", "beta_4_10", 
              "beta_5_7", "beta_5_8", "beta_5_9", "beta_5_10", "beta_6_7", "beta_6_8", 
              "beta_6_9", "beta_6_10")

ppres = data.frame(model_output$BUGSoutput$sims.matrix)

data.mat = as.matrix(cbind(x_1, x_2, x_3, x_4, x_5, x_6, x_7, x_8, x_9, x_10, 
                           x_1_8, x_1_9, x_1_10,
                           x_2_8, x_2_9, x_2_10,
                           x_3_8, x_3_9, x_3_10,
                           x_4_7, x_4_8, x_4_9, x_4_10,
                           x_5_7, x_5_8, x_5_9, x_5_10,
                           x_6_7, x_6_8, x_6_9, x_6_10))

obama.mat = data.mat[which(leaders_nopred$Name == "Barack Obama"),]
naru.mat = data.mat[which(leaders_nopred$Name == "Naruhito (Emperor Reiwa)"),]
francis.mat = data.mat[which(leaders_nopred$Name == "Francis"),]
dalai.mat = data.mat[which(leaders_nopred$Name == "14th Dalai Lama (Tenzin Gyatso)"),]

set.seed(123)
ppset = lapply(seq(1:nrow(ppres)), function(i) {
  r = ppres$r[i]
  betas = ppres[,c(all_betas)][i,]
  beta.mat = as.matrix(betas[2:length(betas)])
  francis.temp = francis.mat %*% t(beta.mat)
  dalai.temp = dalai.mat %*% t(beta.mat)
  obama.temp = obama.mat %*% t(beta.mat)
  naru.temp = naru.mat %*% t(beta.mat)

  francis_logmus = as.numeric(betas["beta_0"]) + francis.temp
  dalai_logmus = as.numeric(betas["beta_0"]) + dalai.temp
  obama_logmus = as.numeric(betas["beta_0"]) + obama.temp
  naru_logmus = as.numeric(betas["beta_0"]) + naru.temp
  
  obama_Ts = rtweibull(10000, r, (1/exp(obama_logmus))^(1/r), 0, 100) 
  naru_Ts = rtweibull(10000, r, (1/exp(naru_logmus))^(1/r), 0, 100) 
  francis_Ts = rtweibull(10000, r, (1/exp(francis_logmus))^(1/r), 0, 100) 
  dalai_Ts = rtweibull(10000, r, (1/exp(dalai_logmus))^(1/r), 0, 100) 
  return(list(obama_mc = obama_Ts, naru_mc = naru_Ts, francis_mc = francis_Ts, dalai_mc = dalai_Ts))
})

fvd = NULL
DalaivFrancis = data.frame(as.numeric(sapply(seq(1:nrow(ppres)), function(i) {
  iter = ppset[[i]]
  fvd = c(fvd, mean(iter$dalai_mc>iter$francis_mc))
  return(fvd)
})))
colnames(DalaivFrancis) = "pdp"

ovn = NULL
ObamavNaruhito = data.frame(as.numeric(sapply(seq(1:nrow(ppres)), function(i) {
  iter = ppset[[i]]
  ovn = c(ovn, mean(iter$obama_mc>iter$naru_mc))
  return(ovn)
})))
colnames(ObamavNaruhito) = "pdp"
```

```{r, plot-post-dist-prob, warning = F, fig.height = 4, fig.width = 10, echo = F}
meandf = mean(DalaivFrancis$pdp)
p1 = ggplot(DalaivFrancis) + 
  geom_density(aes(x=pdp, y = ..scaled..), breaks=seq(0, 1, by = 0.01)) +
   geom_vline(xintercept = c(meandf),color="blue") +
      xlab("Probability") +
      theme(axis.title.y = element_blank()) + 
  annotate("text", x = meandf+0.06, y = 0.5, label = paste("mean =", round(meandf,2)), size=3.5, color = "blue") + 
  labs(caption = paste("Figure 4a. This density plot shows the posterior distribution of the", "probability that the 14th Dalai Lama outlives Pope Francis.", sep = "\n"), size = 4) +
    theme(plot.caption = element_text(hjust = 0))

meandf = mean(ObamavNaruhito$pdp)
p2 = ggplot(ObamavNaruhito) + 
  geom_density(aes(x=pdp, y = ..scaled..), breaks=seq(0, 1, by = 0.01)) +
   geom_vline(xintercept = c(meandf),color="blue")+
      xlab("Probability") +
      theme(axis.title.y = element_blank()) + 
  annotate("text", x = meandf+0.06, y = 0.5, label = paste("mean =", round(meandf,2)), size=3.5, color = "blue") + 
  labs(caption = paste("Figure 4b. This density plot shows the posterior distribution of the", "probability that Obama outlives Emperor Naruhito.", sep = "\n"), size = 4) +
    theme(plot.caption = element_text(hjust = 0))

grid.arrange(p1, p2, left = "Density", ncol=2,
             top = "Figure 4: Posterior Distribution Density Plots")
```

Figure 4 depicts the posterior distribution of the probability that Dalai Lama outlives Pope Francis, and that Obama outlives Emperor Naruhito. The probability that the 14th Dalai Lama will have a longer lifespan than Pope Francis is `r round(mean(DalaivFrancis$pdp),2)` with a 95% confidence interval of (`r round(quantile(DalaivFrancis$pdp, 0.025),2)`, `r round(quantile(DalaivFrancis$pdp, 0.975),2)`). The probability that President Obama will have a longer lifespan than Emperor Naruhito is `r round(mean(ObamavNaruhito$pdp),2)` with a 95% confidence interval of (`r round(quantile(ObamavNaruhito$pdp, 0.025),2)`, `r round(quantile(ObamavNaruhito$pdp, 0.975),2)`). For histograms on the posterior predictive distribution of lifespans for the 4 leaders, see Appendix A.5.

## V c. MCMC and Model Diagnostics 

The combination of traceplots, lag-1 scatterplots, and acf plots suggest the chain for each parameters converges. Code for those plots are included in Appendix A.2. The Rhat's are all close to 1, which is another indicator of convergence. Most of the effective sample sizes are greater than 1000 (the effective sample size of 400 for $r$ is lower, but the number of iterations was kept at 50,000 for computational efficiency).

```{r standardized-resid, include = F}
# calculate and create graphs for standardized residuals
all_betas = c("beta_0", "beta_1", "beta_2", "beta_3", "beta_4", "beta_5", "beta_6",
              "beta_7", "beta_8", "beta_9", "beta_10",  "beta_1_8", "beta_1_9",
              "beta_1_10",  "beta_2_8", "beta_2_9", "beta_2_10", "beta_3_8",
              "beta_3_9", "beta_3_10", "beta_4_7", "beta_4_8", "beta_4_9", "beta_4_10", "beta_5_7",
              "beta_5_8", "beta_5_9", "beta_5_10", "beta_6_7", "beta_6_8", "beta_6_9", "beta_6_10")

# select only non-living leaders to calculate residuals for
no_living <- leaders_data %>%
  filter(Censored == 0)


data.mat = as.matrix(cbind(x_1, x_2, x_3, x_4, x_5, x_6, x_7, x_8, x_9, x_10, 
                           x_1_8, x_1_9, x_1_10,
                           x_2_8, x_2_9, x_2_10,
                           x_3_8, x_3_9, x_3_10,
                           x_4_7, x_4_8, x_4_9, x_4_10,
                           x_5_7, x_5_8, x_5_9, x_5_10,
                           x_6_7, x_6_8, x_6_9, x_6_10))

pred_res = data.frame(t(model_output$BUGSoutput$summary))
r = pred_res$r[1]
betas = pred_res[,c(all_betas)][1,]

beta.mat = as.matrix(betas[2:length(betas)], nrow = p, byrow = TRUE)
temp = data.mat %*% t(beta.mat)
logmus = as.numeric(betas["beta_0"]) + temp

# draw predicted values based on mus calculated above
set.seed(123)
Ts = rtweibull(n, r, (1/exp(logmus))^(1/r), 0, 100) 

#calculate residuals
resid = leaders_nopred$Age.Event - Ts

#calculate standard deviations
meanTs = mean(Ts)
diff = Ts - meanTs
sd = sqrt((1/n)*(sum((diff)^2)) * (1+ (1/n) + (diff)^2/sum((diff)^2)))
```

```{r resid-v-predictor, fig.height=2, fig.width=5, echo = FALSE}
ggplot(data = leaders_nopred, aes(x = Ts, y = resid/sd)) + geom_point() + 
  labs(x = "Predicted Lifespan", y = "Standardized Residual", 
       title = "Figure 5: Residual Plots")
```

```{r resid-v-year, fig.height=2, fig.width=5, echo = FALSE}
ggplot(data = leaders_nopred, aes(x = Birth.Year, y = resid/sd)) + geom_point() +
  labs(x = "Birth Year", y = "Standardized Residual")
```

The standardized residual plot for predicted lifespan shows some patterning. *It appears that our model tends to overpredict lifespan compared to what was actually observed in many cases.* This might be due to the fact that we only have two predictors, Birth Year and Type of Leader. Therefore, we are missing information that might help predict whether or not a leader will die earlier, for example if they have some underlying health condition, etc. However, 

The standardized residuals when plotted against Birth Year show random scattering, however, and this means that our model is not over or underpredicting lifespan according to the year a leader was born.

In order to perform posterior predictive checks, ten simulated datasets were created by first extracting the leaders that were non-censored. There were ten different iterations that performed the same task: every single row of the non-censored leaders and a random sample of the model parameters (from the MCMC chain) was used to define a set of $\mu$'s, and those $\mu$'s were used to simulate a set of lifespans from the Weibull distribution.

```{r, include=F, warning = F}
all_betas = c("beta_0", "beta_1", "beta_2", "beta_3", "beta_4", "beta_5", "beta_6",
              "beta_7", "beta_8", "beta_9", "beta_10",  "beta_1_8", "beta_1_9",
              "beta_1_10",  "beta_2_8", "beta_2_9", "beta_2_10", "beta_3_8",
              "beta_3_9", "beta_3_10", "beta_4_7", "beta_4_8", "beta_4_9", "beta_4_10", 
              "beta_5_7", "beta_5_8", "beta_5_9", "beta_5_10", "beta_6_7", "beta_6_8", 
              "beta_6_9", "beta_6_10")
 non_censored_prediction <- filter(leaders_data, Censored == 0) #get all of the leaders that are non-censored, as these are the only people that you are able to do posterior predictive checks on, intuitively
 K <- 10 # set the total number of iterations
 ysims <- matrix(nrow = nrow(non_censored_prediction), ncol = K) #create a matrix of the resulting simulations
 parameters = c(all_betas, "r")
 res = data.frame(model_output$BUGSoutput$sims.matrix)[,parameters]
 
 for(k in 1:K){ #for each iteration
   for(i in 1:nrow(non_censored_prediction)){ #for each row of the non-censored data
     w <- sample(nrow(res), 1) #sample from the model's simulations
     samp <- res[w,] #get the resulting values from the model's random sample
     val <- non_censored_prediction[i, ] #get the resulting values from the specific row
     
     beta_temp <- samp$beta_0 + as.integer(val$Yr15)*samp$beta_1 + as.integer(val$Yr16)*samp$beta_2 + as.integer(val$Yr17)*samp$beta_3 + as.integer(val$Yr18)*samp$beta_4 +as.integer(val$Yr19)*samp$beta_5 + as.integer(val$Yr20)*samp$beta_6 + as.integer(val$TypeUsPres)*samp$beta_7 + as.integer(val$TypeChinaEmp)*samp$beta_8 + as.integer(val$TypeDalaiLama)*samp$beta_9 + as.integer(val$TypeJapanEmp)*samp$beta_10 + 
       
       as.integer(val$Yr15)*as.integer(val$TypeChinaEmp)*samp$beta_1_8 + as.integer(val$Yr15)*as.integer(val$TypeDalaiLama)*samp$beta_1_9 + as.integer(val$Yr15)*as.integer(val$TypeJapanEmp)*samp$beta_1_10 + 
       as.integer(val$Yr16)*as.integer(val$TypeChinaEmp)*samp$beta_2_8 + as.integer(val$Yr16)*as.integer(val$TypeDalaiLama)*samp$beta_2_9 + as.integer(val$Yr16)*as.integer(val$TypeJapanEmp)*samp$beta_2_10 + 
       as.integer(val$Yr17)*as.integer(val$TypeChinaEmp)*samp$beta_3_8 + as.integer(val$Yr17)*as.integer(val$TypeDalaiLama)*samp$beta_3_9 + as.integer(val$Yr17)*as.integer(val$TypeJapanEmp)*samp$beta_3_10 + 
       as.integer(val$Yr18)*as.integer(val$TypeUsPres)*samp$beta_4_7 + as.integer(val$Yr18)*as.integer(val$TypeChinaEmp)*samp$beta_4_8 + as.integer(val$Yr18)*as.integer(val$TypeDalaiLama)*samp$beta_4_9 + as.integer(val$Yr18)*as.integer(val$TypeJapanEmp)*samp$beta_4_10 + 
       as.integer(val$Yr19)*as.integer(val$TypeUsPres)*samp$beta_5_7 + as.integer(val$Yr19)*as.integer(val$TypeChinaEmp)*samp$beta_5_8 + as.integer(val$Yr19)*as.integer(val$TypeDalaiLama)*samp$beta_5_9 + as.integer(val$Yr19)*as.integer(val$TypeJapanEmp)*samp$beta_5_10 + 
       as.integer(val$Yr20)*as.integer(val$TypeUsPres)*samp$beta_6_7 + as.integer(val$Yr20)*as.integer(val$TypeChinaEmp)*samp$beta_6_8 + as.integer(val$Yr20)*as.integer(val$TypeDalaiLama)*samp$beta_6_9 + as.integer(val$Yr20)*as.integer(val$TypeJapanEmp)*samp$beta_6_10 #calculate the beta values as defined by our model
     mu <- exp(beta_temp) #calculate mu from the betas
     t <- rtweibull(1, samp$r, (1/mu)^(1/samp$r), 50, 100) #put the mu and the sample's r value into the weibull equation
     ysims[i, k] <- t #put the resulting value into the ysims matrix
   }
}
```

```{r include =FALSE}
d <- data.frame(ysims) #create a dataframe from the ysims matrix
d[sapply(d, is.infinite)] <- 100 #set all of the Inf values to the upper truncation value as defined in the previous weibull distribution
```

```{r, echo=F, warning = F}
#Scatterplot showing Birth Year of the Leaders versues their Age
df2 <- data.frame(a = c(d[,1], d[,2], d[,3], d[,4], d[,5], d[,6], d[,7], d[,8], d[,9], d[,10]))
df2$b <- c(non_censored_prediction[,"Birth.Year"], non_censored_prediction[,"Birth.Year"], non_censored_prediction[,"Birth.Year"], non_censored_prediction[,"Birth.Year"], non_censored_prediction[,"Birth.Year"], non_censored_prediction[,"Birth.Year"], non_censored_prediction[,"Birth.Year"], non_censored_prediction[,"Birth.Year"], non_censored_prediction[,"Birth.Year"], non_censored_prediction[,"Birth.Year"])
data <- non_censored_prediction %>%
  select(Age.Event)
new <- seq(1, 167, by=1)
fun <- cbind(d, data) %>%
  (function(data){
    colnames(data) <- c(str_c("Sims", 1:10), "data")
    data
  }) %>%
reshape2::melt() 
colnames(fun) <- c("Simulation_Number_or_the_Actual_Data", "Age")
ggplot(aes(x = Age, group = Simulation_Number_or_the_Actual_Data, 
           color = Simulation_Number_or_the_Actual_Data), data = fun) + 
  geom_density(alpha = .2) + xlab("Age of Death") + 
  guides(color = guide_legend(title = 'Simulation Number or the Actual Data')) + 
  ggtitle("Figure 6: Posterior Predictive Checks Density Plot")
```

The Posterior Predictive Checks Density Plot showcases the curvatures of the ten different simulations done in the posterior predictive checks and how they relate to the actual age of the non-censored individuals. There appears to be a peak within the non-censored individuals at around 70, but most of the simulations are seeing a peak at near 100. For the posterior predictive checks, it appears that our model returns values that are more concentrated around the upper truncation limit, which is why the dataframe's Inf values are encoded as 100 (the upper truncation limit defined in our function). This follows what the standardized residuals found, where most of the values from the model are left-skewed, and the posterior predictive checks is showing that a lot of the leaders are being predicted to having a larger lifespan.


# VI. Sensitivity Analysis

```{r, sensitivity-1, include = F}
# beta ~ normal, mean 0, precision 1; 
# r ~ exp(0.001)
priors1 = "
  beta_0 ~ dnorm(0.0, 1) # Prior on betas are normal with mean 0, precision 1
  beta_1 ~ dnorm(0.0, 1) 
  beta_2 ~ dnorm(0.0, 1) 
  beta_3 ~ dnorm(0.0, 1)
  beta_4 ~ dnorm(0.0, 1) 
  beta_5 ~ dnorm(0.0, 1) 
  beta_6 ~ dnorm(0.0, 1) 
  beta_7 ~ dnorm(0.0, 1) 
  beta_8 ~ dnorm(0.0, 1) 
  beta_9 ~ dnorm(0.0, 1) 
  beta_10 ~ dnorm(0.0, 1) 
 
  beta_1_8 ~ dnorm(0.0, 1) 
  beta_1_9 ~ dnorm(0.0, 1) 
  beta_1_10 ~ dnorm(0.0, 1) 

  beta_2_8 ~ dnorm(0.0, 1) 
  beta_2_9 ~ dnorm(0.0, 1) 
  beta_2_10 ~ dnorm(0.0, 1) 
 
  beta_3_8 ~ dnorm(0.0, 1) 
  beta_3_9 ~ dnorm(0.0, 1) 
  beta_3_10 ~ dnorm(0.0, 1) 
  beta_4_7 ~ dnorm(0.0, 1) 
  beta_4_8 ~ dnorm(0.0, 1) 
  beta_4_9 ~ dnorm(0.0, 1) 
  beta_4_10 ~ dnorm(0.0, 1) 
  beta_5_7 ~ dnorm(0.0, 1) 
  beta_5_8 ~ dnorm(0.0, 1) 
  beta_5_9 ~ dnorm(0.0, 1) 
  beta_5_10 ~ dnorm(0.0, 1) 
  beta_6_7 ~ dnorm(0.0, 1) 
  beta_6_8 ~ dnorm(0.0, 1) 
  beta_6_9 ~ dnorm(0.0, 1) 
  beta_6_10 ~ dnorm(0.0, 1) 

  r ~ dexp(0.001) # Prior on r, Stander et al
  "

sensitivity_1 <- run_model(priors1, "sensitivity1")
```

```{r, sensitivity-2, include = F}
# beta ~ normal, mean 0, precision 1; 
# r ~ Gamma(10,10)
priors2 = "
  beta_0 ~ dnorm(0.0, 1) # Priors on betas are normal with mean 0, precision 1
  beta_1 ~ dnorm(0.0, 1) 
  beta_2 ~ dnorm(0.0, 1) 
  beta_3 ~ dnorm(0.0, 1) 
  beta_4 ~ dnorm(0.0, 1) 
  beta_5 ~ dnorm(0.0, 1) 
  beta_6 ~ dnorm(0.0, 1) 
  beta_7 ~ dnorm(0.0, 1) 
  beta_8 ~ dnorm(0.0, 1) 
  beta_9 ~ dnorm(0.0, 1) 
  beta_10 ~ dnorm(0.0, 1) 
 
  beta_1_8 ~ dnorm(0.0, 1) 
  beta_1_9 ~ dnorm(0.0, 1) 
  beta_1_10 ~ dnorm(0.0, 1) 

  beta_2_8 ~ dnorm(0.0, 1) 
  beta_2_9 ~ dnorm(0.0, 1) 
  beta_2_10 ~ dnorm(0.0, 1) 
 
  beta_3_8 ~ dnorm(0.0, 1) 
  beta_3_9 ~ dnorm(0.0, 1) 
  beta_3_10 ~ dnorm(0.0, 1) 
  beta_4_7 ~ dnorm(0.0, 1) 
  beta_4_8 ~ dnorm(0.0, 1) 
  beta_4_9 ~ dnorm(0.0, 1) 
  beta_4_10 ~ dnorm(0.0, 1) 
  beta_5_7 ~ dnorm(0.0, 1) 
  beta_5_8 ~ dnorm(0.0, 1) 
  beta_5_9 ~ dnorm(0.0, 1) 
  beta_5_10 ~ dnorm(0.0, 1) 
  beta_6_7 ~ dnorm(0.0, 1) 
  beta_6_8 ~ dnorm(0.0, 1) 
  beta_6_9 ~ dnorm(0.0, 1) 
  beta_6_10 ~ dnorm(0.0, 1) 

  r ~ dgamma(10,10) # Prior on r, constant hazard
  "

sensitivity_2 <- run_model(priors2, "sensitivity2")
```

```{r, sensitivity-3, include = F}
# beta ~ normal, mean 0, precision 1; 
# r ~ Gamma(10,100)
priors3 = "
  beta_0 ~ dnorm(0.0, 1) # Priors on betas are normal with mean 0, precision 1
  beta_1 ~ dnorm(0.0, 1) 
  beta_2 ~ dnorm(0.0, 1) 
  beta_3 ~ dnorm(0.0, 1) 
  beta_4 ~ dnorm(0.0, 1) 
  beta_5 ~ dnorm(0.0, 1) 
  beta_6 ~ dnorm(0.0, 1)
  beta_7 ~ dnorm(0.0, 1) 
  beta_8 ~ dnorm(0.0, 1) 
  beta_9 ~ dnorm(0.0, 1) 
  beta_10 ~ dnorm(0.0, 1) 
 
  beta_1_8 ~ dnorm(0.0, 1) 
  beta_1_9 ~ dnorm(0.0, 1) 
  beta_1_10 ~ dnorm(0.0, 1) 

  beta_2_8 ~ dnorm(0.0, 1) 
  beta_2_9 ~ dnorm(0.0, 1) 
  beta_2_10 ~ dnorm(0.0, 1) 
 
  beta_3_8 ~ dnorm(0.0, 1) 
  beta_3_9 ~ dnorm(0.0, 1) 
  beta_3_10 ~ dnorm(0.0, 1) 
  beta_4_7 ~ dnorm(0.0, 1) 
  beta_4_8 ~ dnorm(0.0, 1) 
  beta_4_9 ~ dnorm(0.0, 1) 
  beta_4_10 ~ dnorm(0.0, 1) 
  beta_5_7 ~ dnorm(0.0, 1) 
  beta_5_8 ~ dnorm(0.0, 1) 
  beta_5_9 ~ dnorm(0.0, 1) 
  beta_5_10 ~ dnorm(0.0, 1) 
  beta_6_7 ~ dnorm(0.0, 1) 
  beta_6_8 ~ dnorm(0.0, 1) 
  beta_6_9 ~ dnorm(0.0, 1) 
  beta_6_10 ~ dnorm(0.0, 1) 

  r ~ dgamma(10,100) # Prior on r, decreasing hazard
  "

sensitivity_3 <- run_model(priors3, "sensitivity3")
```

```{r, sensitivity-4, include = F}
# beta ~ normal, mean 0, precision 1/10000; 
# r ~ exp(0.001)
priors4 = "
  beta_0 ~ dnorm(0.0, 1/10000) # Prior on beta_0 is normal with low precision
  beta_1 ~ dnorm(0.0, 1/10000) 
  beta_2 ~ dnorm(0.0, 1/10000) 
  beta_3 ~ dnorm(0.0, 1/10000) 
  beta_4 ~ dnorm(0.0, 1/10000) 
  beta_5 ~ dnorm(0.0, 1/10000) 
  beta_6 ~ dnorm(0.0, 1/10000) 
  beta_7 ~ dnorm(0.0, 1/10000) 
  beta_8 ~ dnorm(0.0, 1/10000) 
  beta_9 ~ dnorm(0.0, 1/10000) 
  beta_10 ~ dnorm(0.0, 1/10000) 
  
  beta_1_8 ~ dnorm(0.0, 1/10000) 
  beta_1_9 ~ dnorm(0.0, 1/10000) 
  beta_1_10 ~ dnorm(0.0, 1/10000) 

  beta_2_8 ~ dnorm(0.0, 1/10000) 
  beta_2_9 ~ dnorm(0.0, 1/10000) 
  beta_2_10 ~ dnorm(0.0, 1/10000) 
 
  beta_3_8 ~ dnorm(0.0, 1/10000) 
  beta_3_9 ~ dnorm(0.0, 1/10000) 
  beta_3_10 ~ dnorm(0.0, 1/10000) 
  beta_4_7 ~ dnorm(0.0, 1/10000) 
  beta_4_8 ~ dnorm(0.0, 1/10000) 
  beta_4_9 ~ dnorm(0.0, 1/10000) 
  beta_4_10 ~ dnorm(0.0, 1/10000) 
  beta_5_7 ~ dnorm(0.0, 1/10000) 
  beta_5_8 ~ dnorm(0.0, 1/10000) 
  beta_5_9 ~ dnorm(0.0, 1/10000) 
  beta_5_10 ~ dnorm(0.0, 1/10000) 
  beta_6_7 ~ dnorm(0.0, 1/10000) 
  beta_6_8 ~ dnorm(0.0, 1/10000) 
  beta_6_9 ~ dnorm(0.0, 1/10000) 
  beta_6_10 ~ dnorm(0.0, 1/10000) 

  r ~ dexp(0.001) # Prior on r, Stander et al
  "

sensitivity_4 <- run_model(priors4, "sensitivity4")
```

```{r, sensitivity-5, include = F}
# beta ~ normal, mean 0, precision 1/10000; 
# r ~ Gamma (10,10)
priors5 = "
  beta_0 ~ dnorm(0.0, 1/10000) # Prior on beta_0 is normal with low precision
  beta_1 ~ dnorm(0.0, 1/10000) 
  beta_2 ~ dnorm(0.0, 1/10000) 
  beta_3 ~ dnorm(0.0, 1/10000) 
  beta_4 ~ dnorm(0.0, 1/10000) 
  beta_5 ~ dnorm(0.0, 1/10000) 
  beta_6 ~ dnorm(0.0, 1/10000) 
  beta_7 ~ dnorm(0.0, 1/10000) 
  beta_8 ~ dnorm(0.0, 1/10000) 
  beta_9 ~ dnorm(0.0, 1/10000) 
  beta_10 ~ dnorm(0.0, 1/10000) 
 
  beta_1_8 ~ dnorm(0.0, 1/10000) 
  beta_1_9 ~ dnorm(0.0, 1/10000) 
  beta_1_10 ~ dnorm(0.0, 1/10000) 
 
  beta_2_8 ~ dnorm(0.0, 1/10000) 
  beta_2_9 ~ dnorm(0.0, 1/10000) 
  beta_2_10 ~ dnorm(0.0, 1/10000) 
 
  beta_3_8 ~ dnorm(0.0, 1/10000) 
  beta_3_9 ~ dnorm(0.0, 1/10000) 
  beta_3_10 ~ dnorm(0.0, 1/10000) 
  beta_4_7 ~ dnorm(0.0, 1/10000) 
  beta_4_8 ~ dnorm(0.0, 1/10000) 
  beta_4_9 ~ dnorm(0.0, 1/10000) 
  beta_4_10 ~ dnorm(0.0, 1/10000) 
  beta_5_7 ~ dnorm(0.0, 1/10000) 
  beta_5_8 ~ dnorm(0.0, 1/10000) 
  beta_5_9 ~ dnorm(0.0, 1/10000) 
  beta_5_10 ~ dnorm(0.0, 1/10000) 
  beta_6_7 ~ dnorm(0.0, 1/10000) 
  beta_6_8 ~ dnorm(0.0, 1/10000) 
  beta_6_9 ~ dnorm(0.0, 1/10000) 
  beta_6_10 ~ dnorm(0.0, 1/10000) 

  r ~ dgamma(10,10) # Prior on r, constant hazard
  "

sensitivity_5 <- run_model(priors5, "sensitivity5")
```

```{r, sensitivity-6, include = F}
# beta ~ normal, mean 0, precision 1/10000; 
# r ~ Gamma (10,100)
priors6 = "
  beta_0 ~ dnorm(0.0, 1/10000) # Prior on beta_0 is normal with low precision
  beta_1 ~ dnorm(0.0, 1/10000) 
  beta_2 ~ dnorm(0.0, 1/10000) 
  beta_3 ~ dnorm(0.0, 1/10000) 
  beta_4 ~ dnorm(0.0, 1/10000) 
  beta_5 ~ dnorm(0.0, 1/10000) 
  beta_6 ~ dnorm(0.0, 1/10000) 
  beta_7 ~ dnorm(0.0, 1/10000) 
  beta_8 ~ dnorm(0.0, 1/10000) 
  beta_9 ~ dnorm(0.0, 1/10000) 
  beta_10 ~ dnorm(0.0, 1/10000) 
 
  beta_1_8 ~ dnorm(0.0, 1/10000) 
  beta_1_9 ~ dnorm(0.0, 1/10000) 
  beta_1_10 ~ dnorm(0.0, 1/10000) 
  
  beta_2_8 ~ dnorm(0.0, 1/10000) 
  beta_2_9 ~ dnorm(0.0, 1/10000) 
  beta_2_10 ~ dnorm(0.0, 1/10000) 
 
  beta_3_8 ~ dnorm(0.0, 1/10000) 
  beta_3_9 ~ dnorm(0.0, 1/10000) 
  beta_3_10 ~ dnorm(0.0, 1/10000) 
  beta_4_7 ~ dnorm(0.0, 1/10000) 
  beta_4_8 ~ dnorm(0.0, 1/10000) 
  beta_4_9 ~ dnorm(0.0, 1/10000) 
  beta_4_10 ~ dnorm(0.0, 1/10000) 
  beta_5_7 ~ dnorm(0.0, 1/10000) 
  beta_5_8 ~ dnorm(0.0, 1/10000) 
  beta_5_9 ~ dnorm(0.0, 1/10000) 
  beta_5_10 ~ dnorm(0.0, 1/10000) 
  beta_6_7 ~ dnorm(0.0, 1/10000) 
  beta_6_8 ~ dnorm(0.0, 1/10000) 
  beta_6_9 ~ dnorm(0.0, 1/10000) 
  beta_6_10 ~ dnorm(0.0, 1/10000) 

  r ~ dgamma(10,100) # Prior on r, decreasing hazard
  "

sensitivity_6 <- run_model(priors6, "sensitivity6")
```

```{r, sensitivity-analysis, warning = F, fig.width=10, fig.height = 5, echo = F}
parameter = "beta_6"
sa1 = data.frame(sensitivity_1$BUGSoutput$sims.matrix) %>%
  select(parameter)
sa2 = data.frame(sensitivity_2$BUGSoutput$sims.matrix) %>%
  select(parameter)
sa3 = data.frame(sensitivity_3$BUGSoutput$sims.matrix) %>%
  select(parameter)
sa4 = data.frame(sensitivity_4$BUGSoutput$sims.matrix) %>%
  select(parameter)
sa5 = data.frame(sensitivity_5$BUGSoutput$sims.matrix) %>%
  select(parameter)
sa6 = data.frame(sensitivity_6$BUGSoutput$sims.matrix) %>%
  select(parameter)

sa_df = data.frame(vals = rbind(sa1, sa2, sa3, sa4, sa5, sa6),
                   type = c(rep("r~Exp(0.001), B~N(0,1)", nrow(sa1)),
                            rep("r~Ga(10,10), B~N(0,1)", nrow(sa2)),
                            rep("r~Ga(10,1000), B~N(0,1)", nrow(sa3)),
                            rep("r~Exp(0.001), B~N(0,10000)", nrow(sa4)),
                            rep("r~Ga(10,10), B~N(0,10000)", nrow(sa5)),
                            rep("r~Ga(10,1000), B~N(0,10000)", nrow(sa6))))

neworder <- c("r~Exp(0.001), B~N(0,1)", "r~Ga(10,10), B~N(0,1)", "r~Ga(10,1000), B~N(0,1)",
              "r~Exp(0.001), B~N(0,10000)", "r~Ga(10,10), B~N(0,10000)", "r~Ga(10,1000), B~N(0,10000)")

sa_df_plot <- arrange(mutate(sa_df, type=factor(type,levels=neworder)), type)

sampled_vals = model_output$BUGSoutput$summary["beta_6", ]
sampled_beta = sampled_vals["mean"]

ggplot(sa_df_plot) + geom_density(aes(x = beta_6)) + 
  facet_wrap(~type,  scales = "free_y", nrow = 2) + 
  geom_vline(xintercept = sampled_beta, color = "blue") +
  labs(x = expression(beta[6]), 
       title = "Figure 7: Sensitivity Analysis for Different Priors",
       caption = paste("Fig. 7 The above plots show sensitivity analysis for different priors on r and the coefficients. The blue line indicates the", "estimate of the coefficient from our model. It appears that the analysis is generally not sensitive to different priors.", sep = "\n")) +
  theme(plot.caption = element_text(hjust = 0.5, vjust = -0.5, size = 12))
``` 

We tested $N(0,1)$ and $N(0,10000)$ priors for the $\beta$s and $Exp(0.001)$ (Stander et al prior), $Gamma(10,10)$ (mean = 1), and $Gamma(10,100)$ (mean = 0.1) priors for $r$. Distribution of $\beta_6$ was approximated using those different priors and plotted above. The blue line, which is the estimate for $\beta_6$ from our model, crosses (or is close to) the mode of all but one of the distributions, so our analysis is mostly robust against changes in prior. However, it is somewhat sensitive to the prior combination of $r \sim Gamma(10,1000)$ and $\beta_6 \sim N(0,1)$ Code to conduct sensitivity analysis for the remaining betas can be found in Appendix A.3.

# VII. Cross Validation

We sought to perform external cross-validation on our model to assess how useful our model would be to predict lifespans of other leaders. The data that we used for the cross-validation was from all of England's monarchs born in or after the 1300s, accessed from Wikipedia. This dataset only included one person that was still alive (Queen Elisabeth II). We assigned leader type `JapanEmp` to all British monarchs since we felt this might be the closest match, given China doesn't have any emperors after 1911. 

```{r include = F}
#read data
monarchs <- read.csv("english_monarchs.csv", header = FALSE)
monarchs$Age <- as.numeric(monarchs$V3) - as.numeric(monarchs$V2)
monarchs <- monarchs %>%
  filter(V2 >= 1300)

monarchs$Age[monarchs$V1 == "Elizabeth II"] <- 94
monarchs$Censored <- 0
monarchs$Censored[monarchs$V1 == "Elizabeth II"] <- 1

monarchs$survival <- monarchs$Age
monarchs$survival[monarchs$V1 == "Elizabeth II"] <- NA
```

```{r include = F}
monarchs$TypeJapanEmp <- 1 #assign JapanEmp as leader type
monarchs <- monarchs %>%
  mutate(Yr14 = as.factor(case_when(V2 <= 1400 ~1,
                                        TRUE ~0)),
         Yr15 = as.factor(case_when(V2 >= 1401 & V2 <= 1500 ~ 1,
                                         TRUE ~0)),
         Yr16 = as.factor(case_when(V2 >= 1501 & V2 <= 1600 ~ 1,
                                         TRUE ~0)),
         Yr17 = as.factor(case_when(V2 >= 1601 & V2 <= 1700 ~ 1,
                                         TRUE ~0)),
         Yr18 = as.factor(case_when(V2 >= 1701 & V2 <= 1800 ~ 1,
                                         TRUE ~0)),
         Yr19 = as.factor(case_when(V2 >= 1801 & V2 <= 1900 ~ 1,
                                         TRUE ~0)),
         Yr20 = as.factor(case_when(V2 >= 1901 & V2 <= 2000 ~ 1,
                                         TRUE ~0))
         ) 

z_1 <- as.numeric(as.character(monarchs$Yr15))
z_2 <- as.numeric(as.character(monarchs$Yr16))
z_3 <- as.numeric(as.character(monarchs$Yr17))
z_4 <-  as.numeric(as.character(monarchs$Yr18))
z_5 <-  as.numeric(as.character(monarchs$Yr19))
z_6 <-  as.numeric(as.character(monarchs$Yr20))
z_7 <- 0
z_8 <- 0
z_9 <- 0
z_10 <- as.numeric(as.character(monarchs$TypeJapanEmp))

# add interaction b/w Yr__ and Type___
z_1_8 <- z_1*z_8; z_1_9 <- z_1*z_9; z_1_10 <- z_1*z_10


z_2_8 <- z_2*z_8
z_2_9 <- z_2*z_9
z_2_10 <- z_2*z_10


z_3_8 <- z_3*z_8
z_3_9 <- z_3*z_9
z_3_10 <- z_3*z_10

z_4_7 <- z_4*z_7
z_4_8 <- z_4*z_8
z_4_9 <- z_4*z_9
z_4_10 <- z_4*z_10

z_5_7 <- z_5*z_7
z_5_8 <- z_5*z_8
z_5_9 <- z_5*z_9
z_5_10 <- z_5*z_10

z_6_7 <- z_6*z_7
z_6_8 <- z_6*z_8
z_6_9 <- z_6*z_9
z_6_10 <- z_6*z_10

cv_data.mat = as.matrix(cbind(z_1, z_2, z_3, z_4, z_5, z_6, z_7, z_8, z_9, z_10, 
                           
                           z_1_8,
                           z_1_9,
                           z_1_10,
                         
                           z_2_8,
                           z_2_9,
                           z_2_10,
                          
                           z_3_8,
                           z_3_9,
                           z_3_10,
                             z_4_7,
                           z_4_8,
                           z_4_9,
                           z_4_10,
                             z_5_7,
                           z_5_8,
                           z_5_9,
                           z_5_10,
                             z_6_7,
                           z_6_8,
                           z_6_9,
                           z_6_10))

beta.mat = as.matrix(betas[2:length(betas)], nrow = p, byrow = TRUE)
temp = cv_data.mat %*% t(beta.mat)
logmus = as.numeric(betas["beta_0"]) + temp

# draw predicted values based on mus calculated above
set.seed(123)
cv_n = nrow(monarchs)
Ts = rtweibull(cv_n, r, (1/exp(logmus))^(1/r), 0, 100) 

#calculate residuals
resid = monarchs$Age - Ts

#calculate standard deviations
meanTs = mean(Ts)
diff = Ts - meanTs
sd = sqrt((1/n)*(sum((diff)^2)) * (1+ (1/n) + (diff)^2/sum((diff)^2)))
```

```{r resid-v-predictorcv, fig.height=2, fig.width=5, echo = FALSE}
ggplot(data = monarchs, aes(x = Ts, y = resid/sd)) + geom_point() + 
  labs(x = "Predicted Lifespan", y = "Standardized Residual",
       title = "Figure 8: Residual Plot for British Monarchs")
```

```{r resid-v-yearcv, fig.height=2, fig.width=5, echo = FALSE}
ggplot(data = monarchs, aes(x = V2, y = resid/sd)) + geom_point() +
  labs(x = "Birth Year", y = "Standardized Residual")
```

As shown in the standardized residuals plots above, the our model didn't do a good job predicting how long British monarchs could live based on their birth year - standardized residuals are very large. In the plot showing Predicted Lifespan and the standardized residuals, it appears to be random. As the birth year of the monarchs increases, there is an upward trend. It seems that our model is overpredicting for leaders in the later centuries. 

The result, however, is perhaps not surprising to see because British monarchs and Japanese emperors are different types of leaders in different cultures and geographical regions, not to mention our model itself lacks other important variables such as leaders' health conditions, access to healthcare, etc. 

# VI. Conclusion and Further Discussion

We sought to compare Popes, US Presidents, Dalai Lamas, Chinese Emperors, and Japanese Emperors to see how their lifespans might be explained by their birth year and types of leadership. Our model has found that both variables are significant predictors and the impact of birth year on lifespan does change based on leadership type. 

One limitation worth noting is that our data does not include election year, so we have no way to control for the fact that Presidents and Popes must have a minimum lifespan. On the other hand, Dalai Lamas can be chosen close to birth and thus have a younger death date. 

Additionally, there is a lack of previous existing work in the field to inform stronger prior choices, especially for the $\beta_i$ coefficients. 

This model could be improved by including more predictors; for example, health varies widely among people, and could lead to a better model for prediction. For further implementations of this research question, it would be valuable to interpret economic or quality of life data as it concerns the different countries that the leaders grew up in, as the conditions that a person live in lead to changes in a person's lifespan. 

# VII. References

Stander, J., Dalla Valle, L., and Cortina-Borja, M. (2018). A Bayesian Survival Analysis of a Historical Dataset: How Long Do Popes Live? The American Statistician 72(4):368-375.

Causes of death statistics - people over 65. (n.d.). Retrieved September 08, 2020, from https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Causes_of_death_statistics_-_people_over_65


# VIII. Appendix

## A.1 Details on the Poisson "Zero-Trick" Method

We use the Poisson "zeros trick," where a set of 0's are created and the likelihood of observing an 0 follows a $Poisson(\phi_i)$ distribution. The likelihood $L_i$ is $Pr(z_i = 0) = exp(-\phi)$. In other words, $\phi_i$ equals $-log(L_i)$. This mechanism is necessary because we don't know the lifespan of currently living people, so we need a way to model their expected survival times. The censored vector has 0 for dead leaders and 1 for alive leaders. The vector censoring_limits contains 100 (chosen as an upper bound on age) for dead leaders and current age for alive leaders. The non-100 observations in censoring_limits are saved in t_censored, and t_censored is taken to the power of r then multiplied by mu_censored to calculate phi_censored, which is the mean parameter of the Poisson likelihood described above.

## A.2 Code for Traceplots, Lag-1 Scatterplots, and Acf Plots

```{r, fig.width = 5, fig.height = 5, include = FALSE}
# run traceplots
parameters = c(all_betas, "r")

res = data.frame(model_output$BUGSoutput$sims.matrix)[,parameters]
colnames(res) <- gsub("^.*\\.","", colnames(res) )

tps <- function(var){
  ggplot(res, aes_(y=as.name(var), x=seq(1,nrow(res)))) +
    geom_line() +
    labs(title=paste("Traceplot of ", as.name(var)),
         x ="Iterations", y = as.name(var))
}

all_trace = lapply(names(res), tps)

p1 = all_trace[1:11]
p2 = all_trace[12:22]
p3 = all_trace[23:33]
```

```{r, fig.width = 5, fig.height = 5, echo = FALSE}
do.call(grid.arrange, p1)
```

```{r, fig.width = 5, fig.height = 5, echo = FALSE}
do.call(grid.arrange, p2)
```

```{r, fig.width = 5, fig.height = 5, echo = FALSE}
do.call(grid.arrange, p3)
```

All of the traceplots and code for plotting is above.

```{r,include = FALSE}
# run lag-1 scatterplots
lag1_df = lapply(seq(1:length(res)), function(i) { lag(res[,i],1) })

res_lag1 = function(i) { # plot for all parameters
  plot(y=res[,i], x= lag1_df[[i]], 
       xlab = paste0(colnames(res)[i], "-1"),
       ylab = paste0(colnames(res)[i]),
       main = paste("Lag-1 Scatter Plot of", colnames(res)[i]))
}
```

```{r, fig.width = 3, fig.height = 3, echo=F}
plot(y=res[,2], x= lag1_df[[2]], 
       xlab = paste0(colnames(res)[2], "-1"),
       ylab = paste0(colnames(res)[2]),
       main = paste("Lag-1 Scatter Plot of", colnames(res)[2]))
```

```{r, include= FALSE}
# run acf plots
acfs = lapply(seq(1,length(res)), function(i) { # plot for all parameters
  acf(res[,i], xlab = "Lag", ylab = "ACF", 
            main = paste("ACF Plot of ", colnames(res)[i]))
})
```

```{r, fig.width = 3, fig.height = 3, echo= FALSE}
acf(res[,2], xlab = "Lag", ylab = "ACF", 
    main = paste("ACF Plot of ", colnames(res)[2]))
```

Display of lag-1 scatterplot and acf plot for $\beta_1$ is shown above, code provided allows generations of plots for all parameters.

*add old model and resid code here*

## A.3 Code for Sensitivity Analysis

```{r, include= F}
parameter = "beta_6" # change parameter here to run for different betas

sa1 = data.frame(sensitivity_1$BUGSoutput$sims.matrix) %>%
  select(parameter)
sa2 = data.frame(sensitivity_2$BUGSoutput$sims.matrix) %>%
  select(parameter)
sa3 = data.frame(sensitivity_3$BUGSoutput$sims.matrix) %>%
  select(parameter)
sa4 = data.frame(sensitivity_4$BUGSoutput$sims.matrix) %>%
  select(parameter)
sa5 = data.frame(sensitivity_5$BUGSoutput$sims.matrix) %>%
  select(parameter)
sa6 = data.frame(sensitivity_6$BUGSoutput$sims.matrix) %>%
  select(parameter)

sa_df = data.frame(vals = rbind(sa1, sa2, sa3, sa4, sa5, sa6),
                   type = c(rep("r~Exp(0.001), B~N(0,1)", nrow(sa1)),
                            rep("r~Ga(10,10), B~N(0,1)", nrow(sa2)),
                            rep("r~Ga(10,1000), B~N(0,1)", nrow(sa3)),
                            rep("r~Exp(0.001), B~N(0,100)", nrow(sa4)),
                            rep("r~Ga(10,10), B~N(0,100)", nrow(sa5)),
                            rep("r~Ga(10,1000), B~N(0,100)", nrow(sa6))))

neworder <- c("r~Exp(0.001), B~N(0,1)", "r~Ga(10,10), B~N(0,1)", "r~Ga(10,1000), B~N(0,1)",
              "r~Exp(0.001), B~N(0,100)", "r~Ga(10,10), B~N(0,100)", "r~Ga(10,1000), B~N(0,100)")

sa_df_plot <- arrange(mutate(sa_df, type=factor(type,levels=neworder)), type)

sampled_vals = model_output$BUGSoutput$summary[parameter, ]
sampled_beta = sampled_vals["mean"]

ggplot(sa_df_plot) + geom_density(aes(x = sa_df_plot[,1])) + 
  facet_wrap(~type,  scales = "free_y", nrow = 2) + 
  geom_vline(xintercept = sampled_beta, color = "blue") +
  labs(x = expression(beta[6]), caption = paste("Fig. 8 The above plots show sensitivity analysis for different priors on r and the coefficients. The blue line indicates the estimate of the", "coefficient from the propsed model. It appears that the analysis is generally not sensitive to different priors."), size = 3) + # change beta[6] to beta being analyzed
  theme(plot.caption = element_text(hjust = 0.5, vjust = -0.5, size = 4))
```

## A.4 Weibull Distributions with Differing r Values

```{r}
par(mfrow=c(2,2))
curve(dweibull(x, shape=0.1, scale = 1), from=0, to=4, main = 'Weibull Distribution (shape = 0.3, scale = 1)')
curve(dweibull(x, shape=0.5, scale = 1), from=0, to=4, main = 'Weibull Distribution (shape = 0.5, scale = 1)')
curve(dweibull(x, shape=0.8, scale = 1), from=0, to=4, main = 'Weibull Distribution (shape = 0.8, scale = 1)')
curve(dweibull(x, shape=1, scale = 1), from=0, to=4, main = 'Weibull Distribution (shape = 1, scale = 1)')
```

## A.5 Histograms of Posterior Predictive Distribution for Lifespan of the 4 Selected Leaders

```{r, francis-dalai, message = F, fig.height=5, fig.width=10, echo = FALSE}
people = c("age_Francis_predictive", "age_Obama_predictive", "age_Dalai_predictive",
"age_Naruhito_predictive")
four_pred = data.frame(model_output$BUGSoutput$sims.matrix)[,people]

francis_dalai = data.frame(plifespans = c(four_pred$age_Francis_predictive, four_pred$age_Dalai_predictive), person = c(rep("Francis", nrow(four_pred)), rep("Dalai", nrow(four_pred))))


francis = data.frame(plifespans = four_pred$age_Francis_predictive)
dalai = data.frame(plifespans = four_pred$age_Dalai_predictive)


flab = paste(paste("Current age:", round(min(francis$plifespans),2), "yrs"),
      paste("Median:", round(median(francis$plifespans),2), "yrs"),
      paste("95% quantile:", round(quantile(francis$plifespans, 0.95),2), "yrs"),
      sep = "\n")

dlab = paste(paste("Current age:", round(min(dalai$plifespans),2), "yrs"),
      paste("Median:", round(median(dalai$plifespans),2),"yrs"),
      paste("95% quantile:", round(quantile(dalai$plifespans, 0.95),2), "yrs"),
      sep = "\n")

p1=ggplot(francis, aes(x=plifespans)) + 
  geom_histogram(aes(y=..density..), binwidth = 0.8, boundary=min(francis$plifespans)) +
  geom_vline(aes(xintercept = min(plifespans)), color = "black")+
  geom_vline(aes(xintercept = median(plifespans)), color = "blue")+
  geom_vline(aes(xintercept = quantile(plifespans, 0.95)), color = "red")+
  geom_hline(aes(yintercept = 0), colour = "black") +
  ylim(c(0, 0.1)) + 
  xlab("Lifespan (yrs)") + 
  ggtitle("Pope Francis") +
  theme(plot.title = element_text(hjust = 0.5), axis.title.y = element_blank()) +
  geom_text(mapping = aes(x = 88.5, y = 0.09, label = flab), size = 3)

p2=ggplot(dalai, aes(x=plifespans)) + 
  geom_histogram(aes(y=..density..), binwidth = 0.8, boundary=min(dalai$plifespans)) +
  geom_vline(aes(xintercept = min(plifespans)), color = "black")+
  geom_vline(aes(xintercept = median(plifespans)), color = "blue")+
  geom_vline(aes(xintercept = quantile(plifespans, 0.95)), color = "red")+
  geom_hline(aes(yintercept = 0), colour = "black") +
  ylim(c(0, 0.1)) +
  xlab("Lifespan (yrs)") + 
  ggtitle("Dalai Lama") +
  theme(plot.title = element_text(hjust = 0.5), axis.title.y = element_blank()) +
  geom_text(mapping = aes(x = 89, y = 0.09, label = dlab), size = 3)

cap = paste("Fig. 4a The posterior predictive probability density function of the lifespan for hypothetical leaders with the same attributes as Pope Francis (right) and the 14th Dalai Lama (left).", "The black vertical line marks current age the blue marks posterior median, and the red marks the posterior 95% quantile.", sep = "\n")

grid.arrange(p1,p2, bottom = textGrob(cap, x =0, just = "left", gp = gpar(fontsize = 9) ),
                    left = "Predictive Posterior density", ncol=2)
```


```{r obama-naru-plot, message = F, fig.height=5, fig.width=10, echo = FALSE}
obama = data.frame(plifespans = four_pred$age_Obama_predictive)
naru = data.frame(plifespans = four_pred$age_Naruhito_predictive)

olab = paste(paste("Current age:", round(min(obama$plifespans),2), "yrs"),
      paste("Median:", round(median(obama$plifespans),2),"yrs"),
      paste("95% quantile:", round(quantile(obama$plifespans, 0.95),2), "yrs"),
      sep = "\n")

nlab = paste(paste("Current age:", round(min(naru$plifespans),2), "yrs"),
      paste("Median:", round(median(naru$plifespans),2),"yrs"),
      paste("95% quantile:", round(quantile(naru$plifespans, 0.95),2), "yrs"),
      sep = "\n")

p1=ggplot(obama, aes(x=plifespans)) + 
  geom_histogram(aes(y=..density..), binwidth = 0.8, boundary=min(obama$plifespans)) +
  geom_vline(aes(xintercept = min(plifespans)), color = "black")+
  geom_vline(aes(xintercept = median(plifespans)), color = "blue")+
  geom_vline(aes(xintercept = quantile(plifespans, 0.95)), color = "red")+
  geom_hline(aes(yintercept = 0), colour = "black") +
  ylim(c(0, 0.07)) + 
  xlab("Lifespan (yrs)") + 
  ggtitle("President Obama") +
  theme(plot.title = element_text(hjust = 0.5), axis.title.y = element_blank()) + 
  geom_text(mapping = aes(x = 72, y = 0.06, label = olab), size = 3)

p2=ggplot(naru, aes(x=plifespans)) + 
  geom_histogram(aes(y=..density..), binwidth = 0.8, boundary=min(naru$plifespans)) +
  geom_vline(aes(xintercept = min(plifespans)), color = "black")+
  geom_vline(aes(xintercept = median(plifespans)), color = "blue")+
  geom_vline(aes(xintercept = quantile(plifespans, 0.95)), color = "red")+
  geom_hline(aes(yintercept = 0), colour = "black") +
  ylim(c(0, 0.07)) +
  xlab("Lifespan (yrs)") + 
  ggtitle("Emperor Naruhito") +
  theme(plot.title = element_text(hjust = 0.5), axis.title.y = element_blank()) +
  geom_text(mapping = aes(x = 73, y = 0.06, label = nlab), size = 3)

cap = paste("Fig. 4b The posterior predictive probability density function of the lifespan for hypothetical leaders with the same attributes as Obama (right) and Emperor", "Naruhito (left). The black vertical line marks current age, the blue marks posterior median, and the red marks the posterior 95% quantile.", sep = "\n")

grid.arrange(p1,p2, bottom = textGrob(cap, x =0, just = "left", gp = gpar(fontsize = 10)),
                    left = "Predictive Posterior density", ncol=2)
```

The histogram of the posterior predictive distributions of the lifespans for a leader with the same birth year and leadership type as Pope Francis and that of a leader with the same above attributes as the 14th Dalai Lama are more uniform. The histogram for a leader with the same birth year and leadership type as President Obama and that of a leader with the same above attributes as Emperor Naruhito are both left skewed, with modes around the 90s.
